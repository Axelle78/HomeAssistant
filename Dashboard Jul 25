climat_card:
  entity: '[[[ return variables.temp ]]]'
  show_name: false
  show_icon: false
  template:
    - temperature_state
    - no_style
  custom_fields:
    icon:
      card:
        type: custom:button-card
        entity: '[[[ return variables.temp ]]]'
        icon: '[[[ return variables.icon ]]]'
        show_icon: true
        show_state: false
        show_name: false
        show_label: true
        template:
          - no_style
        styles:
          icon:
            - width: 18px
            - color: |
                [[[ 
                  if (variables.temp_state > 26)   
                    return "var(--icon-red)"
                  if (variables.temp_state < 19)   
                    return "var(--icon-blue)" 
                  return "var(--icon-off)"
                ]]]               
    temp:
      card:
        type: custom:button-card
        entity: '[[[ return variables.temp ]]]'
        show_state: false
        show_name: false
        show_label: true
        show_icon: false
        label: |
          [[[ return (entity.state* 1).toFixed(1) +"°"  ]]]           
        template:
          - police
          - no_style
        styles:
          label:
            - font-size: 30px
            - font-weight: null
            - color: |
                [[[ 
                  if (variables.temp_state > 26)   
                    return "var(--red)"
                  if (variables.temp_state < 19)   
                    return "var(--blue)"                      
                ]]]  
    hum:
      card:
        type: custom:button-card
        entity: '[[[ return variables.hum ]]]'
        show_state: false
        show_name: false
        show_label: true
        show_icon: false
        label: |
          [[[
             return `<ha-icon
             icon="mdi:water"
             style="width: 15px; height: 13px; ">
             </ha-icon>` + (variables.hum_state* 1).toFixed(0) +"%" 
          ]]]
        template:
          - police
          - no_style
        styles:
          label:
            - font-size: 16px
            - font-weight: 500
            - opacity: 0.8
            - color: |
                [[[ 
                  if (variables.hum_state > 70)   
                    return "var(--red)"
                  if (variables.hum_state < 40)   
                    return "var(--blue)"
                  return "var(--text-on)"
                ]]]    
    title:
      card:
        type: custom:button-card
        template:
          - title_card
        entity: '[[[ return variables.temp ]]]'
        name: |
          [[[ return variables.temp_trend + variables.name  ]]] 
        styles:
          name:
            - justify-self: center
            - font-size: 13px
            - color: var(--text-off)
            - font-weight: 500
          card:
            - padding: 0
    gauge:
      card:
        type: custom:apexcharts-card
        header:
          show: false
          title: '[[[ return variables.name ]]]'
          show_states: true
          colorize_states: true
        experimental:
          brush: false
          color_threshold: true
        chart_type: radialBar
        series:
          - entity: '[[[ return variables.temp ]]]'
            name: température
            color: var(--blue)
            max: 30
            fill_raw: last
          - entity: '[[[ return variables.hum ]]]'
            name: humidité
            color: var(--blue)
            max: 100
            fill_raw: last
        apex_config:
          chart:
            height: 190
          legend:
            show: false
          colors:
            - var(--black)
          plotOptions:
            radialBar:
              hollow:
                margin: 0
                size: 60%
                background: var(--ha-card-background)
              track:
                dropShadow:
                  enabled: true
                  top: 2
                  left: 0
                  blur: 4
                  opacity: 0.15
              dataLabels:
                show: false
                name:
                  offsetY: -10
                  color: '#fff'
                  fontSize: 13px
                value:
                  color: '#fff'
                  fontSize: 30px
                  show: true
          fill:
            type: gradient
            gradient:
              shade: dark
              type: vertical
              gradientToColors:
                - var(--orange)
                - var(--dark-blue)
              stops:
                - 0
                - 100
          stroke:
            lineCap: round
        card_mod:
          style: |
            ha-card {
               font-family: Avenir;
               background-color: transparent;
               box-shadow: none;
             }
  styles:
    card:
      - height: 150px
      - padding: 0
    custom_fields:
      icon:
        - position: absolute
        - width: 100%
        - top: 11%
        - left: 0%
        - opacity: 100%
        - z-index: 1
      title:
        - position: absolute
        - width: 100%
        - top: 31%
        - left: '-02%'
        - opacity: 100%
        - z-index: 2
      temp:
        - position: absolute
        - width: 100%
        - top: 33%
        - left: 0%
        - opacity: 100%
        - z-index: 2
      hum:
        - position: absolute
        - width: 100%
        - top: 58%
        - left: '-02%'
        - opacity: 100%
        - z-index: 2
      gauge:
        - position: absolute
        - width: 100%
        - top: '-06%'
        - left: '-01%'
        - opacity: 100%
        - z-index: 0
button_card_templates:
  card_title:
    tap_action:
      action: none
    show_icon: false
    show_label: true
    show_name: true
    styles:
      card:
        - background-color: rgba(0,0,0,0)
        - box-shadow: none
        - height: auto
        - width: auto
        - margin-top: 2px
        - margin-left: 18px
        - margin-bottom: '-4px'
        - padding: 6px
        - border: none
      grid:
        - grid-template-areas: '''n'' ''l'''
        - grid-template-columns: 1fr
        - grid-template-rows: min-content min-content
      name:
        - justify-self: start
        - font-weight: bold
        - font-size: 1.5rem
      label:
        - justify-self: start
        - font-weight: bold
        - font-size: 1.1rem
        - opacity: '0.4'
  hc_dishwasher_card:
    entity: sensor.lave_vaisselle_operation_state
    name: Bosch Dishwasher
    show_label: true
    tap_action:
      action: none
    hold_action:
      action: none
    double_tap_action:
      action: none
    icon: mdi:dishwasher
    state:
      - value: Ready
        label: Idle
        styles:
          custom_fields:
            bar:
              - display: none
            stat1:
              - display: none
            stat2:
              - visibility: hidden
            stat3:
              - visibility: hidden
      - value: 'Off'
        label: 'Off'
        styles:
          custom_fields:
            bar:
              - display: none
            stat1:
              - display: none
            stat2:
              - visibility: hidden
            stat3:
              - visibility: hidden
    styles:
      card:
        - padding: 20px
        - height: 180px
        - font-family: montserrat
      grid:
        - grid-template-areas: '"i program" "n stat2" "bar bar" "stat1 stat3"'
        - grid-template-columns: 1fr 1fr
        - grid-template-rows: 70px min-content 40px min-content
      name:
        - justify-self: start
        - font-size: 16px
        - font-weight: 500
      label:
        - justify-self: start
        - font-size: 16px
        - font-weight: 500
      icon:
        - width: 36px
      img_cell:
        - justify-self: start
        - align-self: start
        - width: 36px
        - height: 36px
      custom_fields:
        program:
          - justify-self: end
          - align-self: end
          - padding-bottom: 6px
          - font-size: 16px
          - font-weight: 500
          - visibility: >
              [[[ return states['switch.lave_vaisselle_power'].state !== 'off' ?
              'visible' : 'hidden'; ]]]
        stat1:
          - justify-self: start
          - font-size: 12px
          - opacity: 0.7
        stat2:
          - justify-self: end
          - font-size: 16px
          - font-weight: 500
          - visibility: >
              [[[ return states['switch.lave_vaisselle_power'].state !== 'off' ?
              'visible' : 'hidden'; ]]]
        stat3:
          - justify-self: end
          - font-size: 12px
          - opacity: 0.7
          - visibility: |
              [[[ 
                var powerState = states['switch.lave_vaisselle_power'].state;
                if (powerState === 'off') {
                  return 'visible';  // Keep stat3 visible when power is off
                }
                var progress = states['sensor.lave_vaisselle_program_progress'].state;
                if (progress === 'unavailable' || progress === 'unknown' || progress === '') {
                  return 'visible';  // Show stat3 as "Ready" when power is on and progress is empty
                }
                return 'visible';  // Show progress percentage otherwise
              ]]]
        bar:
          - justify-self: start
          - width: 100%
          - border-radius: 6px
          - background: var(--slider-color)
          - height: 16px
    custom_fields:
      bar: |
        [[[ 
          var state = parseFloat(states['sensor.lave_vaisselle_program_progress'].state); 
          if (isNaN(state)) { state = 0; }  // Ensure it defaults to 0 if the state isn't a valid number
          return `<div style="background: var(--slider-color); border-radius: 6px; width: 100%; height: 16px;">
                    <div style="background: var(--color-blue); border-radius: 6px; height: 16px; width: ${state}%;"></div>
                  </div>`;
        ]]]
      program: |
        [[[ 
          var powerState = states['switch.lave_vaisselle_power'].state;
          var program = states['select.lave_vaisselle_active_program'].state;
          var programLabels = {
            "dishcare_lave_vaisselle_program_eco_50": "Eco",
            "dishcare_lave_vaisselle_program_auto_2": "Auto",
            "dishcare_lave_vaisselle_program_intensiv_70": "Heavy",
            "dishcare_lave_vaisselle_program_quick_65": "Express 65°",
            "dishcare_lave_vaisselle_program_night_wash": "Silent",
            "dishcare_lave_vaisselle_program_machine_care": "Machine Care",
            "dishcare_lave_vaisselle_program_pre_rinse": "Pre-rinse"
          };
          
          // If the program is unavailable, unknown, or empty, return an empty string
          if (!program || program === 'unavailable' || program === 'unknown') {
            return "";
          }

          return programLabels[program] || program;  
        ]]]
      stat1: |
        [[[ 
          // Icons for rinse aid and salt status
          var rinseAidState = states['sensor.lave_vaisselle_rinse_aid_nearly_empty'].state;
          var saltState = states['sensor.lave_vaisselle_salt_nearly_empty'].state;
          
          // Set the icon color based on state
          var rinseAidColor = rinseAidState === 'present' ? 'red' : 'gray';
          var saltColor = saltState === 'present' ? 'red' : 'gray';
          
          return ` 
            <span style="color: ${rinseAidColor}; margin-right: 4px;">
              <ha-icon icon="fapro:sparkles" style="width: 16px; height: 16px;"></ha-icon>
            </span>
            <span style="color: ${saltColor};">
              <ha-icon icon="fapro:salt-shaker" style="width: 16px; height: 16px;"></ha-icon>
            </span>
          `;
        ]]]
      stat2: |
        [[[ 
          var powerState = states['switch.lave_vaisselle_power'].state;
          var finishTime = "";
          var program = states['select.lave_vaisselle_active_program'].state;
          
          // If the power is off, return an empty string
          if (powerState === 'off') {
            return "";
          }
          
          // If the program isn't set yet, return "Idle"
          if (!program || program === 'unavailable' || program === 'unknown') {
            return "Idle";
          }
          
          // If the program is running, and finish time is available, show finish time
          if (finishTime && finishTime !== 'unavailable' && finishTime !== 'unknown' && !isNaN(Date.parse(finishTime))) {
            var time = new Date(finishTime);
            var hours = time.getHours();
            var minutes = time.getMinutes();
            return 'Finished at ' + (hours < 10 ? '0' : '') + hours + ':' + (minutes < 10 ? '0' : '') + minutes;
          }
          
          // If the finish time is not available, return an empty string
          return "";
        ]]]
      stat3: |
        [[[ 
          var powerState = states['switch.lave_vaisselle_power'].state;
          if (powerState === 'off') {
            return "Off";  // Display "Off" when the power is off
          }
          
          var progress = states['sensor.lave_vaisselle_program_progress'].state;
          
          // If the progress is unavailable or empty, show "Ready"
          if (progress === 'unavailable' || progress === 'unknown' || progress === '') {
            return "Ready";  // Default to "Ready" when the dishwasher is in idle state
          }
          
          // Otherwise, return the progress percentage
          return progress + '%'; 
        ]]]
views:
  - type: sections
    max_columns: 5
    title: Home
    path: new-home-page2
    visible:
      - user: 9bd2c79bb7c44dd79f5b1aaf38d12367
    sections:
      - type: grid
        cards:
          - type: vertical-stack
            cards:
              - type: custom:circular-timer-card
                entity: timer.timer_2
                bins: 30
                color:
                  - '#1e7883'
                  - '#a9bdbb'
                  - '#ee7256'
                layout: minimal
                color_state: true
            visibility:
              - condition: state
                entity: input_boolean.notification_timer
                state: 'on'
          - type: vertical-stack
            cards:
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                   
                      return '<div style="background-color: rgba(171, 3, 3, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<font size="+2"><b>Poubelle</b></font></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <br/> <font size="+2">' +
                             states["sensor.poubelle_j1"].state + '</font> <br />';
                    
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                      background-color: red;
                     
                    } type: ""
            visibility:
              - condition: state
                entity: input_boolean.notification_poubelle
                state: 'on'
          - type: vertical-stack
            cards:
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                   
                      return '<div style="background-color: rgba(33, 4, 151, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<font size="+2"><b>Anniversaire</b></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <br/> ' +
                             states["sensor.anniversaire"].state + ' <br /></font>';
                    
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                      background-color: rgba(52, 4, 247, 01);
                     
                    } type: ""
            visibility:
              - condition: state
                entity: input_boolean.notification_anniversaire
                state: 'on'
          - show_name: true
            show_icon: false
            type: button
            entity: script.fermer_notification
            grid_options:
              columns: 12
              rows: 1
            name: Fermer
            visibility:
              - condition: or
                conditions:
                  - condition: state
                    entity: input_boolean.notification_anniversaire
                    state: 'on'
                  - condition: state
                    entity: input_boolean.notification_poubelle
                    state: 'on'
                  - condition: state
                    entity: input_boolean.notification_timer
                    state: 'on'
            tap_action:
              action: perform-action
              perform_action: script.fermer_notification
              target: {}
          - type: heading
            icon: mdi:lightning-bolt-circle
            heading: Données ecojoko
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: sensor.cout_tempo_jour_total
                label: |
                  [[[
                     if(states['sensor.evol_cout_hier'].state<0)
                      return  '<b>Coûts</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.cout_tempo_jour_total'].state + ' € <br>' + states['sensor.evol_cout_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_dim.png" width=15% height=20% >' 
                     else
                       return  '<b>Coûts</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.cout_tempo_jour_total'].state + ' € <br>' + states['sensor.evol_cout_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_aug.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi des coûts sur 24h
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.cout_tempo_jour_total
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Côuts EDF
                          entities:
                            - sensor.cout_tempo_jour_total
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
              - type: custom:button-card
                entity: sensor.conso_tempo_jour_total
                label: |
                  [[[
                     if(states['sensor.evol_conso_hier'].state<0)
                      return  '<b>Conso</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.conso_tempo_jour_total'].state + ' kWh <br>' + states['sensor.evol_conso_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_dim.png" width=15% height=20% >'
                     else
                       return '<b>Conso</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.conso_tempo_jour_total'].state + ' kWh <br>' + states['sensor.evol_conso_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_aug.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi de la consommation
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.conso_tempo_jour_total
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Conso EDF
                          entities:
                            - sensor.conso_tempo_jour_total
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: sensor.prodution_kwh
                label: |
                  [[[
                     if(states['sensor.evol_production_hier'].state>0)
                      return  '<b>Production</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.prodution_kwh'].state + ' kWh <br>' + states['sensor.evol_production_hier'].state + ' %<br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_aug.png" width=15% height=20% >'
                     else
                       return '<b>Production</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.prodution_kwh'].state + ' kWh <br>' + states['sensor.evol_production_hier'].state + ' %<br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_dim.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi de la production
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.prodution_kwh
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Production Panneaux
                          entities:
                            - sensor.prodution_kwh
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
              - type: custom:button-card
                entity: sensor.ecojoko_surplus_de_production
                label: |
                  [[[
                     var label = ""
                      label = '<b>Export</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.ecojoko_surplus_de_production'].state + ' kWh <br>' + states['sensor.surplus_edf'].state + ' € <br><br>' 
                      return label;
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi du surplus de production
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.ecojoko_surplus_de_production
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Surplus Panneaux
                          entities:
                            - sensor.ecojoko_surplus_de_production
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
          - type: heading
            icon: mdi:car
            heading: Opel Mokka
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
            grid_options:
              columns: 12
              rows: auto
          - vehicle_image_type: default
            status_image_type: none
            layout_type: single
            formatted_entities: true
            show_location: true
            show_mileage: true
            show_car_state: true
            show_info_icons: true
            help_highlight: true
            sections_order:
              - title
              - image
              - info
              - bar_0
            bars:
              - left_title: Essence
                left_entity: ''
                right_entity: sensor.vxkushpy1sw051977_autonomie_carburant
                bar_color: 'var(--primary-color, #3498db)'
                background_color: 'var(--card-background-color, #121212)'
                border_color: 'var(--divider-color, #555555)'
                left_title_color: 'var(--secondary-text-color, #999999)'
                left_text_color: 'var(--primary-text-color, #ffffff)'
                right_title_color: 'var(--secondary-text-color, #999999)'
                right_text_color: 'var(--primary-text-color, #ffffff)'
                limit_indicator_color: 'var(--error-color, #ff0000)'
                left_title_size: 14
                left_text_size: 14
                right_title_size: 14
                right_text_size: 14
                percentage_text_size: 14
                bar_size: thick
                bar_radius: round
                bar_style: flat
                show_left: true
                show_right: true
                show_percentage: true
                show_left_title: true
                show_left_value: true
                show_right_title: true
                show_right_value: true
                percentage_type: entity
                percentage_amount_entity: ''
                percentage_total_entity: ''
                percentage_attribute: ''
                percentage_template: ''
                alignment: space-between
                width: '100'
                use_gradient: true
                gradient_display_mode: value_based
                gradient_stops:
                  - id: '1'
                    position: 0
                    color: '#ff0000'
                  - id: '2'
                    position: 100
                    color: '#00ff00'
                animation_entity: ''
                animation_state: ''
                animation_type: none
                action_animation_entity: ''
                action_animation_state: ''
                action_animation: none
                entity: sensor.vxkushpy1sw051977_niveau_carburant
                bar_name: Carburant
                left_condition:
                  type: none
                  entity: ''
                  state: ''
                right_condition:
                  type: none
                  entity: ''
                  state: ''
                right_title: 'Autonomie '
                right_template_mode: false
            icon_rows: []
            type: custom:ultra-vehicle-card
            title_alignment: center
            title_size: 24
            title_bold: true
            show_units: true
            vehicle_image_width: 100
            action_image_width: 100
            images:
              - id: n5jb1sc
                name: Mokka
                image_type: url
                image_width: 100
                priority: 0
                image: >-
                  https://raw.githubusercontent.com/Axelle78/test/refs/heads/master/mokka.png
            image_priority_mode: order
            info_rows:
              - id: ulr3oez
                width: '100'
                alignment: center
                vertical_alignment: center
                spacing: medium
                columns: 0
                allow_wrap: false
                info_entities:
                  - id: ntj7ar9
                    entity: sensor.vxkushpy1sw051977_kilometrage
                    name: ''
                    icon: mdi:road-variant
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: false
                    dynamic_icon_template: ''
                    dynamic_color_template_mode: false
                    dynamic_color_template: ''
                  - id: ih1jern
                    entity: sensor.depassement_km
                    icon: mdi:car
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: false
                    dynamic_icon_template: ''
                    dynamic_color_template_mode: true
                    dynamic_color_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      red {%else%} green {%endif%}
                row_name: Kilométrage
              - id: jyfxgib
                width: '100'
                alignment: center
                vertical_alignment: center
                spacing: medium
                columns: 0
                allow_wrap: false
                info_entities:
                  - id: 5yfosks
                    entity: sensor.alerte_km
                    name: ''
                    icon: mdi:alert-circle-check-outline
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: true
                    dynamic_icon_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      mdi:alert
                                {%elif states('sensor.depassement_km') | round(0) <-100 %} mdi:alert-circle-check
                                {%else%} mdi:alert-circle
                                {%endif%}
                    dynamic_color_template_mode: true
                    dynamic_color_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      red
                                {%elif states('sensor.depassement_km') | round(0) <-100 %} green
                                {%else%} yellow
                                {%endif%}
                    template_mode: false
                    value_template: ''
            grid_options:
              columns: 12
              rows: 8
            title: Mokka
          - type: heading
            icon: mdi:speaker
            heading: Actions Alexa
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.la_table
                entity: script.la_table
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.lave_vaisselle
                entity: script.lave_vaisselle
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.1611826806282
                entity: script.1611826806282
            grid_options:
              columns: 24
              rows: 2
        column_span: 1
      - type: grid
        cards:
          - type: heading
            heading: Températures
            heading_style: subtitle
            icon: mdi:thermometer
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: weather.mantes_la_ville
                name: |
                  [[[
                    const state = entity.state;
                    const icons = {
                      sunny: "mdi:weather-sunny",
                      partlycloudy: "mdi:weather-partly-cloudy",
                      cloudy: "mdi:weather-cloudy",
                      rainy: "mdi:weather-rainy",
                      pouring: "mdi:weather-pouring",
                      lightning: "mdi:weather-lightning",
                      lightning_rainy: "mdi:weather-lightning-rainy",
                      windy: "mdi:weather-windy",
                      fog: "mdi:weather-fog",
                      snowy: "mdi:weather-snowy",
                      snowy_rainy: "mdi:weather-snowy-rainy",
                      hail: "mdi:weather-hail",
                      exceptional: "mdi:alert-circle"
                    };
                    const icon = icons[state] || "mdi:weather-cloudy";
                    return `<ha-icon icon="${icon}" style='margin-right:6px; --mdc-icon-size:22px;'></ha-icon><span style='font-size:20px; font-weight:bold;'>Dehors</span>`;
                  ]]]
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
              - type: custom:button-card
                entity: weather.mantes_la_ville
                name: |
                  [[[
                    const state = entity.state;
                    const icons = {
                      sunny: "mdi:weather-sunny",
                      partlycloudy: "mdi:weather-partly-cloudy",
                      cloudy: "mdi:weather-cloudy",
                      rainy: "mdi:weather-rainy",
                      pouring: "mdi:weather-pouring",
                      lightning: "mdi:weather-lightning",
                      lightning_rainy: "mdi:weather-lightning-rainy",
                      windy: "mdi:weather-windy",
                      fog: "mdi:weather-fog",
                      snowy: "mdi:weather-snowy",
                      snowy_rainy: "mdi:weather-snowy-rainy",
                      hail: "mdi:weather-hail",
                      exceptional: "mdi:alert-circle"
                    };
                    const icon = icons[state] || "mdi:weather-cloudy";
                    return `<ha-icon icon="${icon}" style='margin-right:6px; --mdc-icon-size:22px;'></ha-icon><span style='font-size:20px; font-weight:bold;'>Devant</span>`;
                  ]]]
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:sofa" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Salon</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:modern-circular-gauge
                entity: sensor.indoor_exterieur_temperature
                unit: °C
                name: Dehors
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_dehors", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_dehors", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                adaptive_state_color: false
                header_position: bottom
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.temperature_devant
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_devant", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_devant", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.salon_temperature
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_salon", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_salon", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
            grid_options:
              columns: 36
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Chambre</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Chloé</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Lucie</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bottle-wine" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Cave</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:modern-circular-gauge
                entity: sensor.ble_temperature_temperature_chambre
                unit: °C
                name: Dehors
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_chambre", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_chambre", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
              - type: custom:modern-circular-gauge
                entity: sensor.ble_temperature_temperature_chambre_chloe
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_chloe", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_chloe", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.temp_lucie
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_lucie", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_lucie", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.temp_cave_a_vin_temperature
                unit: °C
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
                name: Cave à vin
            grid_options:
              columns: 36
              rows: auto
          - type: heading
            heading: Lumières
            heading_style: subtitle
            icon: mdi:lightbulb
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_lumieres_allumees
                icon: mdi:lightbulb
                color: primary
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:sofa" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon> <span style="font-size:
                  20px; font-weight: bold;">Salon</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background-color: rgba(63, 81, 181, 0.2)
                    - border-radius: 12px
                    - height: 30px
                    - padding: 0 16px
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon> <span style="font-size:
                  20px; font-weight: bold;">Chambre</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background-color: rgba(63, 81, 181, 0.2)
                    - border-radius: 12px
                    - height: 30px
                    - padding: 0 16px
                    - display: flex
                    - align-items: center
                    - justify-content: center
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-light-card
                entity: light.halogene
                name: Halogène
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                card_mod:
                  style: |
                    ha-card {
                    {% if states('light.halogene')=='on'%}
                    --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                    {% endif %};
                    }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
              - type: custom:mushroom-light-card
                entity: light.salon_3
                name: Salon
                icon: mdi:lightbulb
                layout: vertical
                use_light_color: true
                card_mod:
                  style: |
                    ha-card {
                    {% if states('light.salon_3')=='on'%}
                    --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                    {% endif %};
                    }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
            grid_options:
              columns: 12
              rows: auto
          - type: horizontal-stack
            cards:
              - entity: light.ampoules_parent
                name: Chambre
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                icon: mdi:lightbulb-group
                card_mod:
                  style: |
                    ha-card {
                      {% if states('light.ampoules_parent')=='on'%}
                      --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                      {% endif %};
                      }
              - entity: light.go2
                name: Go
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                card_mod:
                  style: >
                    ha-card {
                      {% if states('light.go2')=='on' %}
                    --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                    state_attr('light.go2', 'rgb_color') }}

                    {% endif %};

                    }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
            grid_options:
              columns: 12
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Chloé</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
                    - background-color: rgba(63, 81, 181, 0.2)
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Lucie</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
                    - background-color: rgba(63, 81, 181, 0.2)
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - entity: light.lampe_chloe
                name: Lampe
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                card_mod:
                  style: |
                    ha-card {
                    {% if states('light.lampe_chloe')=='on'%}
                     --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                    state_attr('light.lampe_chloe', 'rgb_color') }}
                    {% endif %};
                    }
              - entity: light.chloe
                name: LED et bureau
                icon: mdi:lightbulb
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: LEDs Chloé
                      content:
                        type: horizontal-stack
                        cards:
                          - entity: light.led_chloe
                            name: LED
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.led_chloe')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.led_chloe', 'rgb_color') }}

                                  {% endif %};

                                  }
                          - entity: light.bureau_chloe
                            name: LED Lit
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.bureau_chloe')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.bureau_chloe', 'rgb_color') }}

                                  {% endif %};

                                  }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                secondary_info: state
                primary_info: name
            grid_options:
              columns: 12
              rows: auto
          - type: horizontal-stack
            cards:
              - entity: light.lampe_2
                name: Lampe
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                card_mod:
                  style: |
                    ha-card {
                     {% if states('light.lampe')=='on'%}
                     --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                      state_attr('light.lampe', 'rgb_color') }}

                     {% endif %};

                     }
              - entity: light.lucie
                name: LEDs
                icon: mdi:lightbulb
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                card_mod:
                  style: |
                    ha-card { 
                      {% if states('light.lucie')=='on'%}
                         --ha-card-box-shadow: 0px 0px 10px 3px rgba{{ state_attr('light.lucie', 'rgb_color') }} 
                      {% endif %};

                      }
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: LEDs Chambre Lucie
                      content:
                        type: horizontal-stack
                        cards:
                          - entity: light.led
                            name: LED
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.led')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.led', 'rgb_color') }}

                                  {% endif %};

                                  }
                          - entity: light.led_lucie
                            name: LED Lit
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.led_lucie')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.led_lucie', 'rgb_color') }}

                                  {% endif %};

                                  }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
            grid_options:
              columns: 12
              rows: auto
        column_span: 2
      - type: grid
        cards:
          - type: heading
            icon: mdi:account
            heading_style: subtitle
            heading: Présences
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personnes_presentes
                icon: mdi:home
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personne_ecole
                icon: mdi:account-school
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personnes_absentes
                icon: mdi:home-export-outline
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.axelle
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.pixel_9_pro_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.pixel_9_pro_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: 0px !important;
                                }
                          - type: template
                            entity: sensor.pixel_9_pro_battery_level
                            icon: |2
                                        {% set bl = states('sensor.pixel_9_pro_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.pixel_9_pro_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl =
                              states('sensor.pixel_9_pro_battery_level') | int
                              %}

                              {% if bl < 100 %} 

                              {{ states('sensor.pixel_9_pro_battery_level') |
                              int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: 0px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.axelle
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Axelle </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:shoe-formal"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.total_steps_2'].state}</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['calendar.axelle'].state == "on")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['sensor.today_axelle'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> A la maison</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['input_text.agendaax'].state != "")
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['input_text.agendaax'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>A la maison</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            grid_options:
              columns: 6
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.richard
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.samsung_a33_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.pixel_7a_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.samsung_a33_battery_level
                            icon: |2
                                        {% set bl = states('sensor.samsung_a33_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.samsung_a33_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl =
                              states('sensor.samsung_a33_battery_level') | int
                              %}

                              {% if bl < 100 %} 

                              {{ states('sensor.samsung_a33_battery_level') |
                              int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: -5px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.richard
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Richard </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:shoe-formal"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.total_steps'].state}</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['calendar.richard'].state == "on")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['sensor.today_richard'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> A la maison</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['input_text.agendaax'].state != "")
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['input_text.agendari'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>A la maison</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.chloe
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.s24_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.s24_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.s24_battery_level
                            icon: |2
                                        {% set bl = states('sensor.s24_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.s24_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl = states('sensor.s24_battery_level') |
                              int %}

                              {% if bl < 100 %} 

                              {{ states('sensor.s24_battery_level') | int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: 0px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.chloe
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Chloé </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:school"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.chloe_moyenne'].state}/20</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['sensor.debut_des_cours_de_chloe_aujourd_hui'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_chloe_aujourd_hui'].state} - ${states['sensor.fin_des_cours_de_chloe_aujourd_hui'].state}</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['sensor.debut_des_cours_de_chloe_demain'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_chloe_demain'].state} - ${states['sensor.fin_des_cours_de_chloe_demain'].state}</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.lucie
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.s23_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.s23_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.s23_battery_level
                            icon: |2
                                        {% set bl = states('sensor.s23_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.s23_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl = states('sensor.s23_battery_level') |
                              int %}

                              {% if bl < 100 %} 

                              {{ states('sensor.s23_battery_level') | int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: -5px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.lucie
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Lucie </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:school"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.moyenne_lucie'].state}/20</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['sensor.debut_des_cours_de_lucie_aujourd_hui'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_lucie_aujourd_hui'].state} - ${states['sensor.fin_des_cours_de_lucie_aujourd_hui'].state}</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['sensor.debut_des_cours_de_lucie_demain'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_lucie_demain'].state} - ${states['sensor.fin_des_cours_de_lucie_demain'].state}</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: heading
            icon: mdi:sun-thermometer
            heading_style: subtitle
            heading: Météo
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.vigilance
                icon: mdi:alarm-light
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
            tap_action:
              action: navigate
              navigation_path: /lovelace/3
          - type: horizontal-stack
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: weather-forecast
                    name: Mantes La Ville
                    entity: weather.mantes_la_jolie
                    forecast_type: daily
                    secondary_info_attribute: humidity
                  - type: custom:hourly-weather
                    visibility:
                      - condition: and
                        conditions:
                          - condition: state
                            entity: input_boolean.notification_anniversaire
                            state: 'off'
                          - condition: state
                            entity: input_boolean.notification_poubelle
                            state: 'off'
                          - condition: state
                            entity: input_boolean.notification_timer
                            state: 'off'
                    entity: weather.mantes_la_jolie
                    name: null
                    icons: true
                    card_mod:
                      style: |
                        ha-card {
                           
                           border-width: 0px;
                           --stack-card-gap: 0; 
                           background: none;
                          }
            grid_options:
              columns: 24
              rows: auto
          - type: heading
            icon: mdi:solar-power
            heading: Panneaux solaire
            heading_style: subtitle
            tap_action:
              action: navigate
              navigation_path: /lovelace/10
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: custom:power-distribution-card
            entities:
              - decimals: '0'
                display_abs: true
                name: solar
                unit_of_display: W
                icon: mdi:solar-power
                producer: true
                entity: sensor.envoy_122250004672_current_power_production
                preset: solar
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
              - decimals: '0'
                display_abs: true
                name: Export
                unit_of_display: W
                icon: mdi:lightning-bolt-outline
                producer: true
                entity: sensor.energy_exporting
                preset: producer
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
                calc_excluded: true
              - decimals: '0'
                display_abs: true
                name: conso
                unit_of_display: W
                consumer: true
                icon: mdi:home
                entity: sensor.envoy_122250004672_current_power_consumption
                preset: consumer
                icon_color:
                  bigger: red
                  equal: green
                  smaller: red
                invert_value: true
              - decimals: '0'
                display_abs: true
                name: Import
                unit_of_display: W
                icon: mdi:transmission-tower
                entity: sensor.energy_importing
                preset: grid
                icon_color:
                  bigger: red
                  equal: gray
                  smaller: red
                invert_value: true
            center:
              type: bars
              content:
                - preset: ratio
                  name: use
                  bar_color: green
                  bar_bg_color: ''
                  entity: ''
                  invert_value: false
                - preset: autarky
                  name: indep
                  bar_color: blue
            animation: flash
            grid_options:
              columns: 24
              rows: 3
          - type: heading
            heading: Chauffage
            heading_style: subtitle
            icon: mdi:radiator
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_chauffage_allumes
                icon: mdi:radiator
                color: state
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: custom:mushroom-climate-card
            entity: climate.chauffage_salon
            layout: vertical
            show_temperature_control: true
            collapsible_controls: true
            grid_options:
              columns: 8
              rows: 2
          - type: custom:mushroom-climate-card
            entity: climate.chauffage_chloe
            layout: vertical
            show_temperature_control: true
            collapsible_controls: true
            grid_options:
              columns: 8
              rows: 2
          - type: custom:mushroom-climate-card
            entity: climate.chauffage_lucie
            layout: vertical
            show_temperature_control: true
            collapsible_controls: true
            grid_options:
              columns: 8
              rows: 2
        column_span: 2
    subview: false
    cards: []
    top_margin: false
    badges:
      - type: custom:mushroom-template-badge
        content: '{{states("sensor.poubelle_j1")}}'
        icon: >-
          {% if states("sensor.poubelle_j1")=="Pas de poubelle demain" %} 
          mdi:trash-can-outline
           
          {%else%} mdi:trash-can {%endif%}
        color: >-
          {% if states("sensor.poubelle_j1")=="Pas de poubelle demain" %} 
          green 

          {%else%} red {%endif%}
        tap_action:
          action: more-info
        entity: sensor.poubelle_j
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: sensor.anniversaire
        icon: mdi:cake-variant
        visibility:
          - condition: state
            entity: sensor.anniversaire
            state_not: Aucun anniversaire aujourd'hui
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: sensor.indoor_pluie_precipitation_aujourd_hui
        visibility:
          - condition: numeric_state
            entity: sensor.indoor_pluie_precipitation_aujourd_hui
            above: 0
        tap_action:
          action: navigate
          navigation_path: /lovelace/3
      - type: custom:mushroom-template-badge
        content: >-
          {% if states('binary_sensor.fenetre_chambre_contact')=="on"%} |
          Chambre {%endif%}

          {% if states('binary_sensor.fenetre_lucie_contact')=="on"%}  | Lucie
          {%endif%}

          {% if states('binary_sensor.fenetre_chloe_contact')=="on"%} | Chloé
          {%endif%} |
        icon: mdi:window-open-variant
        color: green
        visibility:
          - condition: state
            entity: sensor.nb_fenetres_ouvertes
            state_not: '0'
        label: |2
            {% if states('sensor.nb_fenetres_ouvertes') |float ==1 %}
            1 fenêtre ouverte 
            {% else %}
            {{states('sensor.nb_fenetres_ouvertes')}} fenêtres ouvertes
            {%endif%}
      - type: custom:mushroom-template-badge
        content: '{{ states(''sensor.four_temperature'') }} °C'
        icon: mdi:thermometer
        color: |-
          {% if states('sensor.four_job_state')=="preheat" %} orange
          {%elif states('sensor.four_job_state')=="cooking" %}
          green
          {%else%}
          blue
          {%endif%}
        label: Four
        visibility:
          - condition: state
            entity: sensor.four_job_state
            state_not: ready
      - type: custom:mushroom-template-badge
        content: '{{states(''sensor.batterie_surface'')}} %'
        icon: |2-
            {% if states('sensor.batterie_surface') | float <= 20 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-20
            {% elif states('sensor.batterie_surface') | float <= 30 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-30
            {% elif states('sensor.batterie_surface') | float <= 40 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-40
            {% elif states('sensor.batterie_surface') | float <= 50 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-50
            {% elif states('sensor.batterie_surface') | float <= 60 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-60
            {% elif states('sensor.batterie_surface') | float <= 70 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-70
            {% elif states('sensor.batterie_surface') | float <= 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-80
            {% elif states('sensor.batterie_surface') | float > 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery
            {% elif states('sensor.batterie_surface') | float < 30 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-30
            {% elif states('sensor.batterie_surface') | float <= 40 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-40
            {% elif states('sensor.batterie_surface') | float <= 50 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-50
            {% elif states('sensor.batterie_surface') | float <= 60 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-60
            {% elif states('sensor.batterie_surface') | float <= 70 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-70
            {% elif states('sensor.batterie_surface') | float <= 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-80
            {% elif states('sensor.batterie_surface') | float > 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-100

            {%endif%}
        color: >-
          {% if states('ensor.tv_tablette_batterie_powerline_status')=="Online"
          %} green


          {% elif states('sensor.batterie_surface') | float < 30 %} red

          {% elif states('sensor.batterie_surface') | float < 50 %} orange

          {%else%} green

          {%endif%}
        label: Tablette
        tap_action:
          action: more-info
        entity: sensor.batterie_surface
      - type: custom:mushroom-template-badge
        content: |-
          J : {{states('sensor.rte_tempo_couleur_actuelle_visuel')}} /
          J+1 : {{states('sensor.rte_tempo_prochaine_couleur_visuel')}}
        color: red
        icon: ''
    dense_section_placement: false
    theme: Mushroom Shadow
  - type: sections
    max_columns: 5
    title: Home2
    path: new-home-page
    visible:
      - user: 9bd2c79bb7c44dd79f5b1aaf38d12367
      - user: c64b37c12d8844a0b3a33322cfebafdb
      - user: 18ed9336b9ff4bb49b82d2947b779ea4
      - user: 701dcc39561248b9bed396f34ddaa263
      - user: 7d5ec80edbab469b8f2bad5e848f6f1c
      - user: 054f753ee7c84f359637eae37b3c123b
      - user: 0c533ea233854d469f5864fd635a673d
      - user: 1c5b797022114ef99c99a28a971940cf
    sections:
      - type: grid
        cards:
          - type: vertical-stack
            cards:
              - type: custom:circular-timer-card
                entity: timer.timer_2
                bins: 30
                color:
                  - '#1e7883'
                  - '#a9bdbb'
                  - '#ee7256'
                layout: minimal
                color_state: true
            visibility:
              - condition: state
                entity: input_boolean.notification_timer
                state: 'on'
          - type: vertical-stack
            cards:
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                   
                      return '<div style="background-color: rgba(171, 3, 3, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<font size="+2"><b>Poubelle</b></font></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <br/> <font size="+2">' +
                             states["sensor.poubelle_j1"].state + '</font> <br />';
                    
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                      background-color: red;
                     
                    } type: ""
            visibility:
              - condition: state
                entity: input_boolean.notification_poubelle
                state: 'on'
          - type: vertical-stack
            cards:
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                   
                      return '<div style="background-color: rgba(33, 4, 151, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<font size="+2"><b>Anniversaire</b></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <br/> ' +
                             states["sensor.anniversaire"].state + ' <br /></font>';
                    
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                      background-color: rgba(52, 4, 247, 01);
                     
                    } type: ""
            visibility:
              - condition: state
                entity: input_boolean.notification_anniversaire
                state: 'on'
          - show_name: true
            show_icon: false
            type: button
            entity: script.fermer_notification
            grid_options:
              columns: 12
              rows: 1
            name: Fermer
            visibility:
              - condition: or
                conditions:
                  - condition: state
                    entity: input_boolean.notification_anniversaire
                    state: 'on'
                  - condition: state
                    entity: input_boolean.notification_poubelle
                    state: 'on'
                  - condition: state
                    entity: input_boolean.notification_timer
                    state: 'on'
            tap_action:
              action: perform-action
              perform_action: script.fermer_notification
              target: {}
          - type: heading
            icon: mdi:lightning-bolt-circle
            heading: Données ecojoko
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: sensor.cout_tempo_jour_total
                label: |
                  [[[
                     if(states['sensor.evol_cout_hier'].state<0)
                      return  '<b>Coûts</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.cout_tempo_jour_total'].state + ' € <br>' + states['sensor.evol_cout_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_dim.png" width=15% height=20% >' 
                     else
                       return  '<b>Coûts</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.cout_tempo_jour_total'].state + ' € <br>' + states['sensor.evol_cout_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_aug.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi des coûts sur 24h
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.cout_tempo_jour_total
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Côuts EDF
                          entities:
                            - sensor.cout_tempo_jour_total
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
              - type: custom:button-card
                entity: sensor.conso_tempo_jour_total
                label: |
                  [[[
                     if(states['sensor.evol_conso_hier'].state<0)
                      return  '<b>Conso</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.conso_tempo_jour_total'].state + ' kWh <br>' + states['sensor.evol_conso_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_dim.png" width=15% height=20% >'
                     else
                       return '<b>Conso</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.conso_tempo_jour_total'].state + ' kWh <br>' + states['sensor.evol_conso_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_aug.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi de la consommation
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.conso_tempo_jour_total
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Conso EDF
                          entities:
                            - sensor.conso_tempo_jour_total
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: sensor.prodution_kwh
                label: |
                  [[[
                     if(states['sensor.evol_production_hier'].state>0)
                      return  '<b>Production</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.prodution_kwh'].state + ' kWh <br>' + states['sensor.evol_production_hier'].state + ' %<br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_aug.png" width=15% height=20% >'
                     else
                       return '<b>Production</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.prodution_kwh'].state + ' kWh <br>' + states['sensor.evol_production_hier'].state + ' %<br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_dim.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi de la production
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.prodution_kwh
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Production Panneaux
                          entities:
                            - sensor.prodution_kwh
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
              - type: custom:button-card
                entity: sensor.ecojoko_surplus_de_production
                label: |
                  [[[
                     var label = ""
                      label = '<b>Export</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.ecojoko_surplus_de_production'].state + ' kWh <br>' + states['sensor.surplus_edf'].state + ' € <br><br>' 
                      return label;
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi du surplus de production
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.ecojoko_surplus_de_production
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Surplus Panneaux
                          entities:
                            - sensor.ecojoko_surplus_de_production
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
          - type: heading
            icon: mdi:car
            heading: Opel Mokka
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
            grid_options:
              columns: 12
              rows: auto
          - vehicle_image_type: default
            status_image_type: none
            layout_type: single
            formatted_entities: true
            show_location: true
            show_mileage: true
            show_car_state: true
            show_info_icons: true
            help_highlight: true
            sections_order:
              - title
              - image
              - info
              - bar_0
            bars:
              - left_title: Essence
                left_entity: ''
                right_entity: sensor.vxkushpy1sw051977_autonomie_carburant
                bar_color: 'var(--primary-color, #3498db)'
                background_color: 'var(--card-background-color, #121212)'
                border_color: 'var(--divider-color, #555555)'
                left_title_color: 'var(--secondary-text-color, #999999)'
                left_text_color: 'var(--primary-text-color, #ffffff)'
                right_title_color: 'var(--secondary-text-color, #999999)'
                right_text_color: 'var(--primary-text-color, #ffffff)'
                limit_indicator_color: 'var(--error-color, #ff0000)'
                left_title_size: 14
                left_text_size: 14
                right_title_size: 14
                right_text_size: 14
                percentage_text_size: 14
                bar_size: thick
                bar_radius: round
                bar_style: flat
                show_left: true
                show_right: true
                show_percentage: true
                show_left_title: true
                show_left_value: true
                show_right_title: true
                show_right_value: true
                percentage_type: entity
                percentage_amount_entity: ''
                percentage_total_entity: ''
                percentage_attribute: ''
                percentage_template: ''
                alignment: space-between
                width: '100'
                use_gradient: true
                gradient_display_mode: value_based
                gradient_stops:
                  - id: '1'
                    position: 0
                    color: '#ff0000'
                  - id: '2'
                    position: 100
                    color: '#00ff00'
                animation_entity: ''
                animation_state: ''
                animation_type: none
                action_animation_entity: ''
                action_animation_state: ''
                action_animation: none
                entity: sensor.vxkushpy1sw051977_niveau_carburant
                bar_name: Carburant
                left_condition:
                  type: none
                  entity: ''
                  state: ''
                right_condition:
                  type: none
                  entity: ''
                  state: ''
                right_title: 'Autonomie '
                right_template_mode: false
            icon_rows: []
            type: custom:ultra-vehicle-card
            title_alignment: center
            title_size: 24
            title_bold: true
            show_units: true
            vehicle_image_width: 100
            action_image_width: 100
            images:
              - id: n5jb1sc
                name: Mokka
                image_type: url
                image_width: 100
                priority: 0
                image: >-
                  https://raw.githubusercontent.com/Axelle78/test/refs/heads/master/mokka.png
            image_priority_mode: order
            info_rows:
              - id: ulr3oez
                width: '100'
                alignment: center
                vertical_alignment: center
                spacing: medium
                columns: 0
                allow_wrap: false
                info_entities:
                  - id: ntj7ar9
                    entity: sensor.vxkushpy1sw051977_kilometrage
                    name: ''
                    icon: mdi:road-variant
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: false
                    dynamic_icon_template: ''
                    dynamic_color_template_mode: false
                    dynamic_color_template: ''
                  - id: ih1jern
                    entity: sensor.depassement_km
                    icon: mdi:car
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: false
                    dynamic_icon_template: ''
                    dynamic_color_template_mode: true
                    dynamic_color_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      red {%else%} green {%endif%}
                row_name: Kilométrage
              - id: jyfxgib
                width: '100'
                alignment: center
                vertical_alignment: center
                spacing: medium
                columns: 0
                allow_wrap: false
                info_entities:
                  - id: 5yfosks
                    entity: sensor.alerte_km
                    name: ''
                    icon: mdi:alert-circle-check-outline
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: true
                    dynamic_icon_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      mdi:alert
                                {%elif states('sensor.depassement_km') | round(0) <-100 %} mdi:alert-circle-check
                                {%else%} mdi:alert-circle
                                {%endif%}
                    dynamic_color_template_mode: true
                    dynamic_color_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      red
                                {%elif states('sensor.depassement_km') | round(0) <-100 %} green
                                {%else%} yellow
                                {%endif%}
                    template_mode: false
                    value_template: ''
            grid_options:
              columns: 12
              rows: 8
            title: Mokka
          - type: heading
            icon: mdi:speaker
            heading: Actions Alexa
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.la_table
                entity: script.la_table
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.lave_vaisselle
                entity: script.lave_vaisselle
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.1611826806282
                entity: script.1611826806282
            grid_options:
              columns: 24
              rows: 2
        column_span: 1
      - type: grid
        cards:
          - type: heading
            heading: Températures
            heading_style: subtitle
            icon: mdi:thermometer
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: weather.mantes_la_ville
                name: |
                  [[[
                    const state = entity.state;
                    const icons = {
                      sunny: "mdi:weather-sunny",
                      partlycloudy: "mdi:weather-partly-cloudy",
                      cloudy: "mdi:weather-cloudy",
                      rainy: "mdi:weather-rainy",
                      pouring: "mdi:weather-pouring",
                      lightning: "mdi:weather-lightning",
                      lightning_rainy: "mdi:weather-lightning-rainy",
                      windy: "mdi:weather-windy",
                      fog: "mdi:weather-fog",
                      snowy: "mdi:weather-snowy",
                      snowy_rainy: "mdi:weather-snowy-rainy",
                      hail: "mdi:weather-hail",
                      exceptional: "mdi:alert-circle"
                    };
                    const icon = icons[state] || "mdi:weather-cloudy";
                    return `<ha-icon icon="${icon}" style='margin-right:6px; --mdc-icon-size:22px;'></ha-icon><span style='font-size:20px; font-weight:bold;'>Dehors</span>`;
                  ]]]
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
              - type: custom:button-card
                entity: weather.mantes_la_ville
                name: |
                  [[[
                    const state = entity.state;
                    const icons = {
                      sunny: "mdi:weather-sunny",
                      partlycloudy: "mdi:weather-partly-cloudy",
                      cloudy: "mdi:weather-cloudy",
                      rainy: "mdi:weather-rainy",
                      pouring: "mdi:weather-pouring",
                      lightning: "mdi:weather-lightning",
                      lightning_rainy: "mdi:weather-lightning-rainy",
                      windy: "mdi:weather-windy",
                      fog: "mdi:weather-fog",
                      snowy: "mdi:weather-snowy",
                      snowy_rainy: "mdi:weather-snowy-rainy",
                      hail: "mdi:weather-hail",
                      exceptional: "mdi:alert-circle"
                    };
                    const icon = icons[state] || "mdi:weather-cloudy";
                    return `<ha-icon icon="${icon}" style='margin-right:6px; --mdc-icon-size:22px;'></ha-icon><span style='font-size:20px; font-weight:bold;'>Devant</span>`;
                  ]]]
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:sofa" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Salon</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:modern-circular-gauge
                entity: sensor.indoor_exterieur_temperature
                unit: °C
                name: Dehors
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_dehors", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_dehors", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                adaptive_state_color: false
                header_position: bottom
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.temperature_devant
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_devant", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_devant", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.salon_temperature
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_salon", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_salon", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
            grid_options:
              columns: 36
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Chambre</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Chloé</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Lucie</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bottle-wine" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Cave</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background: none
                    - box-shadow: none
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:modern-circular-gauge
                entity: sensor.ble_temperature_temperature_chambre
                unit: °C
                name: Dehors
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_chambre", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_chambre", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
              - type: custom:modern-circular-gauge
                entity: sensor.ble_temperature_temperature_chambre_chloe
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_chloe", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_chloe", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.temp_lucie
                unit: °C
                name: Devant
                icon: >-
                  {% if is_state("input_boolean.room_temp_rising_lucie", "on")
                  %}mdi:thermometer-chevron-up{% elif
                  is_state("input_boolean.room_temp_falling_lucie", "on")
                  %}mdi:thermometer-chevron-down{% endif %}
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
              - type: custom:modern-circular-gauge
                entity: sensor.temp_cave_a_vin_temperature
                unit: °C
                max: 30
                min: 10
                needle: true
                smooth_segments: true
                adaptive_icon_color: true
                segments:
                  - from: 13
                    color:
                      - 11
                      - 182
                      - 239
                  - from: 19
                    color:
                      - 43
                      - 255
                      - 0
                  - from: 24
                    color:
                      - 252
                      - 161
                      - 3
                secondary: {}
                tertiary: {}
                show_header: false
                name: Cave à vin
            grid_options:
              columns: 36
              rows: auto
          - type: heading
            heading: Lumières
            heading_style: subtitle
            icon: mdi:lightbulb
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_lumieres_allumees
                icon: mdi:lightbulb
                color: primary
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:sofa" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon> <span style="font-size:
                  20px; font-weight: bold;">Salon</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background-color: rgba(63, 81, 181, 0.2)
                    - border-radius: 12px
                    - height: 30px
                    - padding: 0 16px
                    - display: flex
                    - align-items: center
                    - justify-content: center
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon> <span style="font-size:
                  20px; font-weight: bold;">Chambre</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - background-color: rgba(63, 81, 181, 0.2)
                    - border-radius: 12px
                    - height: 30px
                    - padding: 0 16px
                    - display: flex
                    - align-items: center
                    - justify-content: center
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-light-card
                entity: light.halogene
                name: Halogène
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                card_mod:
                  style: |
                    ha-card {
                    {% if states('light.halogene')=='on'%}
                    --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                    {% endif %};
                    }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
              - type: custom:mushroom-light-card
                entity: light.salon_3
                name: Salon
                icon: mdi:lightbulb
                layout: vertical
                use_light_color: true
                card_mod:
                  style: |
                    ha-card {
                    {% if states('light.salon_3')=='on'%}
                    --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                    {% endif %};
                    }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
            grid_options:
              columns: 12
              rows: auto
          - type: horizontal-stack
            cards:
              - entity: light.ampoules_parent
                name: Chambre
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                icon: mdi:lightbulb-group
                card_mod:
                  style: |
                    ha-card {
                      {% if states('light.ampoules_parent')=='on'%}
                      --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                      {% endif %};
                      }
              - entity: light.go2
                name: Go
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                card_mod:
                  style: >
                    ha-card {
                      {% if states('light.go2')=='on' %}
                    --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                    state_attr('light.go2', 'rgb_color') }}

                    {% endif %};

                    }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
            grid_options:
              columns: 12
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Chloé</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
                    - background-color: rgba(63, 81, 181, 0.2)
              - type: custom:button-card
                name: >
                  <ha-icon icon="mdi:bed" style="margin-right: 6px;
                  --mdc-icon-size: 24px;"></ha-icon><span style="font-size:
                  20px; font-weight: bold;">Lucie</span>
                show_icon: false
                show_name: true
                tap_action:
                  action: none
                styles:
                  card:
                    - height: 30px
                    - padding: 0
                    - display: flex
                    - align-items: center
                    - justify-content: center
                    - background-color: rgba(63, 81, 181, 0.2)
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - entity: light.lampe_chloe
                name: Lampe
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                card_mod:
                  style: |
                    ha-card {
                    {% if states('light.lampe_chloe')=='on'%}
                     --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                    state_attr('light.lampe_chloe', 'rgb_color') }}
                    {% endif %};
                    }
              - entity: light.chloe
                name: LED et bureau
                icon: mdi:lightbulb
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: LEDs Chloé
                      content:
                        type: horizontal-stack
                        cards:
                          - entity: light.led_chloe
                            name: LED
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.led_chloe')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.led_chloe', 'rgb_color') }}

                                  {% endif %};

                                  }
                          - entity: light.bureau_chloe
                            name: LED Lit
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.bureau_chloe')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.bureau_chloe', 'rgb_color') }}

                                  {% endif %};

                                  }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                secondary_info: state
                primary_info: name
            grid_options:
              columns: 12
              rows: auto
          - type: horizontal-stack
            cards:
              - entity: light.lampe_2
                name: Lampe
                icon: mdi:ceiling-light
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
                card_mod:
                  style: |
                    ha-card {
                     {% if states('light.lampe')=='on'%}
                     --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                      state_attr('light.lampe', 'rgb_color') }}

                     {% endif %};

                     }
              - entity: light.lucie
                name: LEDs
                icon: mdi:lightbulb
                layout: vertical
                use_light_color: true
                type: custom:mushroom-light-card
                card_mod:
                  style: |
                    ha-card { 
                      {% if states('light.lucie')=='on'%}
                         --ha-card-box-shadow: 0px 0px 10px 3px rgba{{ state_attr('light.lucie', 'rgb_color') }} 
                      {% endif %};

                      }
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: LEDs Chambre Lucie
                      content:
                        type: horizontal-stack
                        cards:
                          - entity: light.led
                            name: LED
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.led')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.led', 'rgb_color') }}

                                  {% endif %};

                                  }
                          - entity: light.led_lucie
                            name: LED Lit
                            icon: mdi:lightbulb
                            layout: vertical
                            use_light_color: true
                            type: custom:mushroom-light-card
                            card_mod:
                              style: |
                                ha-card {
                                  {% if states('light.led_lucie')=='on'%}
                                  --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                                  state_attr('light.led_lucie', 'rgb_color') }}

                                  {% endif %};

                                  }
                layout_options:
                  grid_columns: 1
                  grid_rows: 2
            grid_options:
              columns: 12
              rows: auto
        column_span: 2
      - type: grid
        cards:
          - type: heading
            icon: mdi:account
            heading_style: subtitle
            heading: Présences
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personnes_presentes
                icon: mdi:home
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personne_ecole
                icon: mdi:account-school
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personnes_absentes
                icon: mdi:home-export-outline
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.axelle
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.pixel_9_pro_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.pixel_9_pro_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: 0px !important;
                                }
                          - type: template
                            entity: sensor.pixel_9_pro_battery_level
                            icon: |2
                                        {% set bl = states('sensor.pixel_9_pro_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.pixel_9_pro_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl =
                              states('sensor.pixel_9_pro_battery_level') | int
                              %}

                              {% if bl < 100 %} 

                              {{ states('sensor.pixel_9_pro_battery_level') |
                              int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: 0px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.axelle
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Axelle </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:shoe-formal"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.total_steps_2'].state}</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['calendar.axelle'].state == "on")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['sensor.today_axelle'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> A la maison</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['input_text.agendaax'].state != "")
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['input_text.agendaax'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>A la maison</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            grid_options:
              columns: 6
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.richard
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.samsung_a33_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.pixel_7a_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.samsung_a33_battery_level
                            icon: |2
                                        {% set bl = states('sensor.samsung_a33_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.samsung_a33_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl =
                              states('sensor.samsung_a33_battery_level') | int
                              %}

                              {% if bl < 100 %} 

                              {{ states('sensor.samsung_a33_battery_level') |
                              int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: -5px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.richard
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Richard </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:shoe-formal"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.total_steps'].state}</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['calendar.richard'].state == "on")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['sensor.today_richard'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> A la maison</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['input_text.agendaax'].state != "")
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['input_text.agendari'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>A la maison</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.chloe
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.s24_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.s24_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.s24_battery_level
                            icon: |2
                                        {% set bl = states('sensor.s24_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.s24_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl = states('sensor.s24_battery_level') |
                              int %}

                              {% if bl < 100 %} 

                              {{ states('sensor.s24_battery_level') | int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: 0px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.chloe
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Chloé </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:school"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.chloe_moyenne'].state}/20</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['sensor.debut_des_cours_de_chloe_aujourd_hui'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_chloe_aujourd_hui'].state} - ${states['sensor.fin_des_cours_de_chloe_aujourd_hui'].state}</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['sensor.debut_des_cours_de_chloe_demain'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_chloe_demain'].state} - ${states['sensor.fin_des_cours_de_chloe_demain'].state}</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.lucie
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.s23_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.s23_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.s23_battery_level
                            icon: |2
                                        {% set bl = states('sensor.s23_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.s23_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl = states('sensor.s23_battery_level') |
                              int %}

                              {% if bl < 100 %} 

                              {{ states('sensor.s23_battery_level') | int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: -5px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.lucie
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Lucie </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:school"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.moyenne_lucie'].state}/20</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['sensor.debut_des_cours_de_lucie_aujourd_hui'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_lucie_aujourd_hui'].state} - ${states['sensor.fin_des_cours_de_lucie_aujourd_hui'].state}</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['sensor.debut_des_cours_de_lucie_demain'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_lucie_demain'].state} - ${states['sensor.fin_des_cours_de_lucie_demain'].state}</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: heading
            icon: mdi:sun-thermometer
            heading_style: subtitle
            heading: Météo
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.vigilance
                icon: mdi:alarm-light
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
            tap_action:
              action: navigate
              navigation_path: /lovelace/3
          - type: horizontal-stack
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: weather-forecast
                    name: Mantes La Ville
                    entity: weather.mantes_la_jolie
                    forecast_type: daily
                    secondary_info_attribute: humidity
                  - type: custom:hourly-weather
                    visibility:
                      - condition: and
                        conditions:
                          - condition: state
                            entity: input_boolean.notification_anniversaire
                            state: 'off'
                          - condition: state
                            entity: input_boolean.notification_poubelle
                            state: 'off'
                          - condition: state
                            entity: input_boolean.notification_timer
                            state: 'off'
                    entity: weather.mantes_la_jolie
                    name: null
                    icons: true
                    card_mod:
                      style: |
                        ha-card {
                           
                           border-width: 0px;
                           --stack-card-gap: 0; 
                           background: none;
                          }
            grid_options:
              columns: 24
              rows: auto
          - type: heading
            icon: mdi:solar-power
            heading: Panneaux solaire
            heading_style: subtitle
            tap_action:
              action: navigate
              navigation_path: /lovelace/10
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: custom:power-distribution-card
            entities:
              - decimals: '0'
                display_abs: true
                name: solar
                unit_of_display: W
                icon: mdi:solar-power
                producer: true
                entity: sensor.envoy_122250004672_current_power_production
                preset: solar
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
              - decimals: '0'
                display_abs: true
                name: Export
                unit_of_display: W
                icon: mdi:lightning-bolt-outline
                producer: true
                entity: sensor.energy_exporting
                preset: producer
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
                calc_excluded: true
              - decimals: '0'
                display_abs: true
                name: conso
                unit_of_display: W
                consumer: true
                icon: mdi:home
                entity: sensor.envoy_122250004672_current_power_consumption
                preset: consumer
                icon_color:
                  bigger: red
                  equal: green
                  smaller: red
                invert_value: true
              - decimals: '0'
                display_abs: true
                name: Import
                unit_of_display: W
                icon: mdi:transmission-tower
                entity: sensor.energy_importing
                preset: grid
                icon_color:
                  bigger: red
                  equal: gray
                  smaller: red
                invert_value: true
            center:
              type: bars
              content:
                - preset: ratio
                  name: use
                  bar_color: green
                  bar_bg_color: ''
                  entity: ''
                  invert_value: false
                - preset: autarky
                  name: indep
                  bar_color: blue
            animation: flash
            grid_options:
              columns: 24
              rows: 3
          - type: heading
            heading: Chauffage
            heading_style: subtitle
            icon: mdi:radiator
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_chauffage_allumes
                icon: mdi:radiator
                color: state
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: custom:mushroom-climate-card
            entity: climate.chauffage_salon
            layout: vertical
            show_temperature_control: true
            collapsible_controls: true
            grid_options:
              columns: 8
              rows: 2
          - type: custom:mushroom-climate-card
            entity: climate.chauffage_chloe
            layout: vertical
            show_temperature_control: true
            collapsible_controls: true
            grid_options:
              columns: 8
              rows: 2
          - type: custom:mushroom-climate-card
            entity: climate.chauffage_lucie
            layout: vertical
            show_temperature_control: true
            collapsible_controls: true
            grid_options:
              columns: 8
              rows: 2
        column_span: 2
    subview: false
    cards: []
    top_margin: false
    badges:
      - type: custom:mushroom-template-badge
        content: '{{states("sensor.poubelle_j1")}}'
        icon: >-
          {% if states("sensor.poubelle_j1")=="Pas de poubelle demain" %} 
          mdi:trash-can-outline
           
          {%else%} mdi:trash-can {%endif%}
        color: >-
          {% if states("sensor.poubelle_j1")=="Pas de poubelle demain" %} 
          green 

          {%else%} red {%endif%}
        tap_action:
          action: more-info
        entity: sensor.poubelle_j
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: sensor.anniversaire
        icon: mdi:cake-variant
        visibility:
          - condition: state
            entity: sensor.anniversaire
            state_not: Aucun anniversaire aujourd'hui
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: sensor.indoor_pluie_precipitation_aujourd_hui
        visibility:
          - condition: numeric_state
            entity: sensor.indoor_pluie_precipitation_aujourd_hui
            above: 0
        tap_action:
          action: navigate
          navigation_path: /lovelace/3
      - type: custom:mushroom-template-badge
        content: >-
          {% if states('binary_sensor.fenetre_chambre_contact')=="on"%} |
          Chambre {%endif%}

          {% if states('binary_sensor.fenetre_lucie_contact')=="on"%}  | Lucie
          {%endif%}

          {% if states('binary_sensor.fenetre_chloe_contact')=="on"%} | Chloé
          {%endif%} |
        icon: mdi:window-open-variant
        color: green
        visibility:
          - condition: state
            entity: sensor.nb_fenetres_ouvertes
            state_not: '0'
        label: |2
            {% if states('sensor.nb_fenetres_ouvertes') |float ==1 %}
            1 fenêtre ouverte 
            {% else %}
            {{states('sensor.nb_fenetres_ouvertes')}} fenêtres ouvertes
            {%endif%}
      - type: custom:mushroom-template-badge
        content: '{{ states(''sensor.four_temperature'') }} °C'
        icon: mdi:thermometer
        color: |-
          {% if states('sensor.four_job_state')=="preheat" %} orange
          {%elif states('sensor.four_job_state')=="cooking" %}
          green
          {%else%}
          blue
          {%endif%}
        label: Four
        visibility:
          - condition: state
            entity: sensor.four_job_state
            state_not: ready
      - type: custom:mushroom-template-badge
        content: '{{states(''sensor.batterie_surface'')}} %'
        icon: |2-
            {% if states('sensor.batterie_surface') | float <= 20 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-20
            {% elif states('sensor.batterie_surface') | float <= 30 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-30
            {% elif states('sensor.batterie_surface') | float <= 40 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-40
            {% elif states('sensor.batterie_surface') | float <= 50 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-50
            {% elif states('sensor.batterie_surface') | float <= 60 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-60
            {% elif states('sensor.batterie_surface') | float <= 70 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-70
            {% elif states('sensor.batterie_surface') | float <= 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-80
            {% elif states('sensor.batterie_surface') | float > 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery
            {% elif states('sensor.batterie_surface') | float < 30 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-30
            {% elif states('sensor.batterie_surface') | float <= 40 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-40
            {% elif states('sensor.batterie_surface') | float <= 50 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-50
            {% elif states('sensor.batterie_surface') | float <= 60 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-60
            {% elif states('sensor.batterie_surface') | float <= 70 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-70
            {% elif states('sensor.batterie_surface') | float <= 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-80
            {% elif states('sensor.batterie_surface') | float > 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-100

            {%endif%}
        color: >-
          {% if states('ensor.tv_tablette_batterie_powerline_status')=="Online"
          %} green


          {% elif states('sensor.batterie_surface') | float < 30 %} red

          {% elif states('sensor.batterie_surface') | float < 50 %} orange

          {%else%} green

          {%endif%}
        label: Tablette
        tap_action:
          action: more-info
        entity: sensor.batterie_surface
      - type: custom:mushroom-template-badge
        content: |-
          J : {{states('sensor.rte_tempo_couleur_actuelle_visuel')}} /
          J+1 : {{states('sensor.rte_tempo_prochaine_couleur_visuel')}}
        color: red
        icon: ''
    dense_section_placement: false
    theme: Mushroom Shadow
  - title: Home(Old)
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:lightbulb
            heading: Lumière et températures
            heading_style: subtitle
            tap_action:
              action: navigate
              navigation_path: /lovelace/1
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_lumieres_allumees
                icon: mdi:lightbulb
                color: primary
          - type: horizontal-stack
            cards:
              - entities:
                  - sensor.indoor_exterieur_temperature
                labels: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 5
                  - color: '#1bfd1b'
                    value: 15
                  - color: '#fdf31b'
                    value: 20
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                name: Dehors
                font_size: 100
                line_color: green
                points_per_hour: 6
                height: 60
                show:
                  labels: true
                type: custom:mini-graph-card
              - animate: true
                name: Devant
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 5
                  - color: '#1bfd1b'
                    value: 15
                  - color: '#fdf31b'
                    value: 20
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.temperature_devant
                labels: false
                font_size: 100
                line_color: green
                points_per_hour: 6
                height: 60
                show:
                  labels: true
                type: custom:mini-graph-card
          - type: entities
            entities:
              - type: divider
            card_mod:
              style: |
                ha-card {
                   
                   border-width: 0px;

                   background: none;
                  }
          - type: custom:mushroom-light-card
            entity: light.couloir
            name: Couloir
            fill_container: false
            layout: horizontal
            card_mod:
              style: |
                ha-card {
                {% if states('light.couloir')=='on'%}
                --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                {% endif %};
                }
            grid_options:
              columns: 6
              rows: 1
          - type: tile
            entity: input_text.garage
            tap_action:
              action: more-info
            icon_tap_action:
              action: none
            icon: mdi:home-lightbulb-outline
            hide_state: false
            vertical: false
            show_entity_picture: false
            card_mod:
              style: |
                ha-card {
                {% if states('input_text.garage')=='Allumé'%}
                --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                {% endif %};
                }
          - type: entities
            entities:
              - type: divider
            card_mod:
              style: |
                ha-card {
                   
                   border-width: 0px;

                   background: none;
                  }
          - graph: line
            type: sensor
            entity: sensor.salon_temperature
            detail: 1
            name: Salon
            card_mod:
              style: >
                ha-card {

                {% if states('light.salon_3')=='on' or
                states('light.halogene')=='on' %}

                --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)

                {% endif %};

                }
          - type: custom:mushroom-light-card
            entity: light.halogene
            name: Halogène
            icon: mdi:ceiling-light
            layout: vertical
            use_light_color: true
            card_mod:
              style: |
                ha-card {
                {% if states('light.halogene')=='on'%}
                --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                {% endif %};
                }
            layout_options:
              grid_columns: 1
              grid_rows: 2
          - type: custom:mushroom-light-card
            entity: light.salon_3
            name: Salon
            icon: mdi:lightbulb
            layout: vertical
            use_light_color: true
            card_mod:
              style: |
                ha-card {
                {% if states('light.salon_3')=='on'%}
                --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                {% endif %};
                }
            layout_options:
              grid_columns: 1
              grid_rows: 2
          - type: entities
            entities:
              - type: divider
            card_mod:
              style: |
                ha-card {
                   
                   border-width: 0px;

                   background: none;
                  }
          - graph: line
            type: sensor
            entity: sensor.ble_temperature_temperature_chambre
            detail: 1
            name: Chambre
            card_mod:
              style: |
                ha-card {
                  {% if states('light.chambre_parents')=='on' or states('light.go2')=='on' %}
                  --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                  {% endif %};
                  }
          - entity: light.ampoules_parent
            name: Chambre
            layout: vertical
            use_light_color: true
            type: custom:mushroom-light-card
            layout_options:
              grid_columns: 1
              grid_rows: 2
            icon: mdi:lightbulb-group
            card_mod:
              style: |
                ha-card {
                  {% if states('light.ampoules_parent')=='on'%}
                  --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)
                  {% endif %};
                  }
          - entity: light.go2
            name: Go
            icon: mdi:ceiling-light
            layout: vertical
            use_light_color: true
            type: custom:mushroom-light-card
            card_mod:
              style: >
                ha-card {
                  {% if states('light.go2')=='on' %}
                --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                state_attr('light.go2', 'rgb_color') }}

                {% endif %};

                }
            layout_options:
              grid_columns: 1
              grid_rows: 2
          - graph: line
            type: sensor
            entity: sensor.ble_temperature_temperature_chambre_chloe
            detail: 1
            name: Chloé
            card_mod:
              style: >
                ha-card {

                {% if states('light.bureau_chloe')=='on' or
                states('light.led_chloe')=='on' or
                states('light.lampe_chloe')=='on'%}
                 --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)}

                {% endif %};

                }
          - entity: light.lampe_chloe
            name: Lampe
            icon: mdi:ceiling-light
            layout: vertical
            use_light_color: true
            type: custom:mushroom-light-card
            layout_options:
              grid_columns: 1
              grid_rows: 2
            card_mod:
              style: |
                ha-card {
                {% if states('light.lampe_chloe')=='on'%}
                 --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                state_attr('light.lampe_chloe', 'rgb_color') }}
                {% endif %};
                }
          - entity: light.chloe
            name: LED et bureau
            icon: mdi:lightbulb
            layout: vertical
            use_light_color: true
            type: custom:mushroom-light-card
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  browser_id: THIS
                  size: normal
                  title: LEDs Chloé
                  content:
                    type: horizontal-stack
                    cards:
                      - entity: light.led_chloe
                        name: LED
                        icon: mdi:lightbulb
                        layout: vertical
                        use_light_color: true
                        type: custom:mushroom-light-card
                        card_mod:
                          style: |
                            ha-card {
                              {% if states('light.led_chloe')=='on'%}
                              --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                              state_attr('light.led_chloe', 'rgb_color') }}

                              {% endif %};

                              }
                      - entity: light.bureau_chloe
                        name: LED Lit
                        icon: mdi:lightbulb
                        layout: vertical
                        use_light_color: true
                        type: custom:mushroom-light-card
                        card_mod:
                          style: |
                            ha-card {
                              {% if states('light.bureau_chloe')=='on'%}
                              --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                              state_attr('light.bureau_chloe', 'rgb_color') }}

                              {% endif %};

                              }
            layout_options:
              grid_columns: 1
              grid_rows: 2
            secondary_info: state
            primary_info: name
            card_mod:
              style: |
                ha-card { 
                  {% if states('light.chloe')=='on'%}
                     --ha-card-box-shadow: 0px 0px 10px 3px rgba{{ state_attr('light.chloe', 'rgb_color') }} 
                  {% endif %};

                  }
          - graph: line
            type: sensor
            entity: sensor.temp_lucie
            detail: 1
            name: Lucie
            icon: mdi:thermometer
            card_mod:
              style: |
                ha-card {
                 {% if states('light.lampe')=='on' or states('light.led')=='on' or states('light.led_lucie')=='on' %}
                 --ha-card-box-shadow: 0px 0px 10px 3px rgba(255,252,158)

                 {% endif %};

                 }
          - entity: light.lampe_2
            name: Lampe
            icon: mdi:ceiling-light
            layout: vertical
            use_light_color: true
            type: custom:mushroom-light-card
            layout_options:
              grid_columns: 1
              grid_rows: 2
            card_mod:
              style: |
                ha-card {
                 {% if states('light.lampe')=='on'%}
                 --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                  state_attr('light.lampe', 'rgb_color') }}

                 {% endif %};

                 }
          - entity: light.lucie
            name: LEDs
            icon: mdi:lightbulb
            layout: vertical
            use_light_color: true
            type: custom:mushroom-light-card
            card_mod:
              style: |
                ha-card { 
                  {% if states('light.lucie')=='on'%}
                     --ha-card-box-shadow: 0px 0px 10px 3px rgba{{ state_attr('light.lucie', 'rgb_color') }} 
                  {% endif %};

                  }
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  browser_id: THIS
                  size: normal
                  title: LEDs Chambre Lucie
                  content:
                    type: horizontal-stack
                    cards:
                      - entity: light.led
                        name: LED
                        icon: mdi:lightbulb
                        layout: vertical
                        use_light_color: true
                        type: custom:mushroom-light-card
                        card_mod:
                          style: |
                            ha-card {
                              {% if states('light.led')=='on'%}
                              --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                              state_attr('light.led', 'rgb_color') }}

                              {% endif %};

                              }
                      - entity: light.led_lucie
                        name: LED Lit
                        icon: mdi:lightbulb
                        layout: vertical
                        use_light_color: true
                        type: custom:mushroom-light-card
                        card_mod:
                          style: |
                            ha-card {
                              {% if states('light.led_lucie')=='on'%}
                              --ha-card-box-shadow: 0px 0px 10px 3px rgba{{
                              state_attr('light.led_lucie', 'rgb_color') }}

                              {% endif %};

                              }
            layout_options:
              grid_columns: 1
              grid_rows: 2
          - type: entities
            entities:
              - type: divider
            card_mod:
              style: |
                ha-card {
                   
                   border-width: 0px;

                   background: none;
                  }
          - graph: line
            type: sensor
            detail: 1
            name: Cave à Vin
            icon: mdi:thermometer
            entity: sensor.temp_cave_a_vin_temperature
          - graph: line
            type: sensor
            detail: 1
            name: Toilettes
            icon: mdi:thermometer
            entity: sensor.temp_toilettes
      - type: grid
        cards:
          - type: heading
            icon: mdi:message-alert
            heading: Notification
            heading_style: title
            visibility:
              - condition: or
                conditions:
                  - condition: state
                    entity: input_boolean.notification_anniversaire
                    state: 'on'
                  - condition: state
                    entity: input_boolean.notification_poubelle
                    state: 'on'
          - type: vertical-stack
            cards:
              - type: custom:circular-timer-card
                entity: timer.timer_2
                bins: 30
                color:
                  - '#1e7883'
                  - '#a9bdbb'
                  - '#ee7256'
                layout: minimal
                color_state: true
            visibility:
              - condition: state
                entity: input_boolean.notification_timer
                state: 'on'
          - type: vertical-stack
            cards:
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                   
                      return '<div style="background-color: rgba(171, 3, 3, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<font size="+2"><b>Poubelle</b></font></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <br/> <font size="+2">' +
                             states["sensor.poubelle_j1"].state + '</font> <br />';
                    
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                      background-color: red;
                     
                    } type: ""
            visibility:
              - condition: state
                entity: input_boolean.notification_poubelle
                state: 'on'
          - type: vertical-stack
            cards:
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                   
                      return '<div style="background-color: rgba(33, 4, 151, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<font size="+2"><b>Anniversaire</b></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <br/> ' +
                             states["sensor.anniversaire"].state + ' <br /></font>';
                    
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                      background-color: rgba(52, 4, 247, 01);
                     
                    } type: ""
            visibility:
              - condition: state
                entity: input_boolean.notification_anniversaire
                state: 'on'
          - show_name: true
            show_icon: false
            type: button
            entity: script.fermer_notification
            grid_options:
              columns: 12
              rows: 1
            name: Fermer
            visibility:
              - condition: or
                conditions:
                  - condition: state
                    entity: input_boolean.notification_anniversaire
                    state: 'on'
                  - condition: state
                    entity: input_boolean.notification_poubelle
                    state: 'on'
                  - condition: state
                    entity: input_boolean.notification_timer
                    state: 'on'
            tap_action:
              action: perform-action
              perform_action: script.fermer_notification
              target: {}
          - type: heading
            icon: mdi:account
            heading_style: subtitle
            heading: Présences
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personnes_presentes
                icon: mdi:home
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personne_ecole
                icon: mdi:account-school
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_personnes_absentes
                icon: mdi:home-export-outline
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.axelle
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.pixel_9_pro_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.pixel_9_pro_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: 0px !important;
                                }
                          - type: template
                            entity: sensor.pixel_9_pro_battery_level
                            icon: |2
                                        {% set bl = states('sensor.pixel_9_pro_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.pixel_9_pro_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl =
                              states('sensor.pixel_9_pro_battery_level') | int
                              %}

                              {% if bl < 100 %} 

                              {{ states('sensor.pixel_9_pro_battery_level') |
                              int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: 0px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.axelle
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Axelle </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:shoe-formal"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.total_steps_2'].state}</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['calendar.axelle'].state == "on")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['sensor.today_axelle'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> A la maison</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['input_text.agendaax'].state != "")
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['input_text.agendaax'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>A la maison</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.richard
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.samsung_a33_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.pixel_7a_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.samsung_a33_battery_level
                            icon: |2
                                        {% set bl = states('sensor.samsung_a33_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.samsung_a33_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl =
                              states('sensor.samsung_a33_battery_level') | int
                              %}

                              {% if bl < 100 %} 

                              {{ states('sensor.samsung_a33_battery_level') |
                              int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: -5px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.richard
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Richard </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:shoe-formal"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.total_steps'].state}</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['calendar.richard'].state == "on")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['sensor.today_richard'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> A la maison</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['input_text.agendaax'].state != "")
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>${states['input_text.agendari'].state}  </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-clock"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span>A la maison</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.chloe
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.s24_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.s24_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.s24_battery_level
                            icon: |2
                                        {% set bl = states('sensor.s24_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.s24_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl = states('sensor.s24_battery_level') |
                              int %}

                              {% if bl < 100 %} 

                              {{ states('sensor.s24_battery_level') | int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: 0px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.chloe
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Chloé </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:school"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.chloe_moyenne'].state}/20</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['sensor.debut_des_cours_de_chloe_aujourd_hui'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_chloe_aujourd_hui'].state} - ${states['sensor.fin_des_cours_de_chloe_aujourd_hui'].state}</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['sensor.debut_des_cours_de_chloe_demain'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_chloe_demain'].state} - ${states['sensor.fin_des_cours_de_chloe_demain'].state}</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:swipe-card
                parameters:
                  effect: coverflow
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mushroom-person-card
                        entity: person.lucie
                        use_entity_picture: true
                        hide_name: false
                        layout: horizontal
                        card_mod:
                          style: |
                            ha-card {
                                border: none;
                                padding: 0;
                                 }
                            :host {
                                 --mush-icon-size: 80px;  
                                 --chip-box-shadow: none;
                                  --chip-background: none;
                                 } 
                            hui-vertical-stack-card $: |
                              div#root > * {
                              margin: -5px !important;
                            }
                      - type: custom:mushroom-chips-card
                        chips:
                          - type: template
                            icon_color: |2-
                                        {% set state=states('sensor.s23_battery_state') %}
                                        {% if state=='charging' %}
                                        green
                                        {% elif state=='discharging' %}
                                        #6f6f6f
                                       {% endif %}
                            entity: sensor.s23_battery_state
                            icon: mdi:power-plug
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                   padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                div#root > * {
                                margin: -5px !important;
                                }
                          - type: template
                            entity: sensor.s23_battery_level
                            icon: |2
                                        {% set bl = states('sensor.s23_battery_level') | int %}
                                        {% if bl < 10 %} mdi:battery-outline
                                        {% elif bl < 20 %} mdi:battery-10
                                        {% elif bl < 30 %} mdi:battery-20
                                        {% elif bl < 40 %} mdi:battery-30
                                        {% elif bl < 50 %} mdi:battery-40
                                        {% elif bl < 60 %} mdi:battery-50
                                        {% elif bl < 70 %} mdi:battery-60
                                        {% elif bl < 80 %} mdi:battery-70
                                        {% elif bl < 90 %} mdi:battery-80
                                        {% elif bl < 100 %} mdi:battery-90
                                        {% elif bl == 100 %} mdi:battery
                                        {% else %} mdi:battery-unknown
                                        {% endif %}
                            icon_color: |2-
                                        {% set bl = states('sensor.s23_battery_level') | int %}
                                        {% if bl < 10 %} red
                                        {% elif bl < 20 %} red
                                        {% elif bl < 30 %} red
                                        {% elif bl < 40 %} orange
                                        {% elif bl < 50 %} orange
                                        {% elif bl < 60 %} green
                                        {% elif bl < 70 %} green
                                        {% elif bl < 80 %} green
                                        {% elif bl < 90 %} green
                                        {% elif bl < 100 %} green
                                        {% elif bl == 100 %} green
                                        {% else %} grey
                                        {% endif %}
                            content: >
                              {% set bl = states('sensor.s23_battery_level') |
                              int %}

                              {% if bl < 100 %} 

                              {{ states('sensor.s23_battery_level') | int }}%

                              {% endif %}
                            tap_action:
                              action: more-info
                            card_mod:
                              style: |
                                ha-card {
                                  padding: 0;
                                  --chip-border-width: 0px;
                                  --chip-box-shadow: none;
                                  --chip-background: none;
                                  padding-top: 0px;
                                margin-top: -30px;
                                padding-bottom: 0px;
                                padding-left: 0px;
                                padding-right: 0px;
                                }
                                hui-vertical-stack-card $: |
                                  div#root > * {
                                  margin: -5px !important;
                                }
                        alignment: center
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:button-card
                        entity: person.lucie
                        show_name: false
                        show_icon: false
                        aspect_ratio: 4/2
                        size: 50px
                        styles:
                          card:
                            - padding: 4%
                          custom_fields:
                            name:
                              - font-size: 20px;
                              - position: absolute
                              - left: 4%
                              - top: 12%
                              - color: '#ffffff'
                            steps:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 35%
                              - color: '#ffffff'
                            today:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 55%
                              - color: '#ffffff'
                            tomorrow:
                              - font-size: 15px;
                              - align-self: left
                              - position: absolute
                              - left: 4%
                              - top: 75%
                              - color: '#ffffff'
                        custom_fields:
                          name: |
                            [[[ return '<span> Lucie </span>'
                            ]]]
                          steps: |
                            [[[
                              return `<ha-icon
                                icon="mdi:school"
                                style="width: 20px; height: 20px;"></ha-icon
                                <span> ${states['sensor.moyenne_lucie'].state}/20</span>`
                            ]]]
                          today: |
                            [[[
                              if (states['sensor.debut_des_cours_de_lucie_aujourd_hui'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_lucie_aujourd_hui'].state} - ${states['sensor.fin_des_cours_de_lucie_aujourd_hui'].state}</span>`
                            ]]]
                          tomorrow: |
                            [[[
                              if (states['sensor.debut_des_cours_de_lucie_demain'].state == "Pas cours")
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> Pas cours </span>`
                              else 
                                return `<ha-icon
                                  icon="mdi:calendar-account-outline"
                                  style="width: 22px; height: 22px;">
                                  </ha-icon>
                                  <span> ${states['sensor.debut_des_cours_de_lucie_demain'].state} - ${states['sensor.fin_des_cours_de_lucie_demain'].state}</span>`
                            ]]]
                        card_mod:
                          style: |
                            ha-card { 
                              background-color: rgba(0,0,0,0);
                              box-shadow: none;
                              font-color: white;
                              font-size: 15;
                            }
            layout_options:
              grid_columns: 2
              grid_rows: auto
          - type: heading
            icon: mdi:sun-thermometer
            heading_style: subtitle
            heading: Météo
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.vigilance
                icon: mdi:alarm-light
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
            tap_action:
              action: navigate
              navigation_path: /lovelace/3
          - type: custom:stack-in-card
            cards:
              - type: weather-forecast
                name: Mantes La Ville
                entity: weather.mantes_la_jolie
                forecast_type: daily
                secondary_info_attribute: humidity
              - type: custom:hourly-weather
                visibility:
                  - condition: and
                    conditions:
                      - condition: state
                        entity: input_boolean.notification_anniversaire
                        state: 'off'
                      - condition: state
                        entity: input_boolean.notification_poubelle
                        state: 'off'
                      - condition: state
                        entity: input_boolean.notification_timer
                        state: 'off'
                entity: weather.mantes_la_jolie
                name: null
                icons: true
                card_mod:
                  style: |
                    ha-card {
                       
                       border-width: 0px;
                       --stack-card-gap: 0; 
                       background: none;
                      }
              - type: glance
                visibility:
                  - condition: and
                    conditions:
                      - condition: state
                        entity: input_boolean.notification_anniversaire
                        state: 'off'
                      - condition: state
                        entity: input_boolean.notification_poubelle
                        state: 'off'
                      - condition: state
                        entity: input_boolean.notification_timer
                        state: 'off'
                entities:
                  - entity: sensor.lune
                    name: Lune
                  - entity: sun.sun
                    name: Soleil
                  - entity: sensor.season
                    name: Saison
          - type: heading
            icon: mdi:speaker
            heading: Actions Alexa
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.la_table
                entity: script.la_table
                size: 30%
                style: |
                  ha-card {
                    margin-bottom: -4px;
                    border-radius: 10px;
                    
                  }
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.lave_vaisselle
                entity: script.lave_vaisselle
                size: 30%
                style: |
                  ha-card {
                    margin-bottom: -4px;
                    border-radius: 10px;
                    
                  }
              - type: custom:button-card
                tap_action:
                  action: call-service
                  service: script.1611826806282
                entity: script.1611826806282
                size: 30%
                style: |
                  ha-card {
                    margin-bottom: -4px;
                    border-radius: 10px;
                    
                  }
      - type: grid
        cards:
          - type: heading
            heading: Chauffage
            heading_style: subtitle
            icon: mdi:radiator
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.nb_chauffage_allumes
                icon: mdi:radiator
                color: state
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: custom:stack-in-card
            cards:
              - type: custom:mushroom-climate-card
                entity: climate.chauffage_salon
                fill_container: true
                show_temperature_control: true
                collapsible_controls: false
                hvac_modes:
                  - heat
                  - 'off'
                name: Salon
                primary_info: name
                secondary_info: state
                icon: mdi:radiator
                tap_action:
                  action: toggle
                grid_options:
                  columns: 12
                  rows: 1
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                        --ha-card-border-width: 0;
                      --card-primary-font-size: 18px;
                      --card-secondary-font-size: 15px;

                     {% if state_attr('climate.chauffage_salon','hvac_action')=='idle'%}
                      background: linear-gradient(to right, lightblue, blue);
                      {% elif state_attr('climate.chauffage_salon','hvac_action')=='heating'%}
                      background: linear-gradient(to right, orange, red);
                      {% endif %};
                    }
              - type: custom:mushroom-template-card
                primary: >-
                  Conso Instantannée  :
                  {{states('sensor.consommation_instantannee_chauffage') |
                  float(0) | round(0)}} W 
                secondary: ' Conso journée : {{states(''sensor.salon_daily_consumption'') | float(0) | round(2)}} kWh'
                card_mod:
                  style: |
                    ha-card {
                      z-index: 1;
                      --ha-card-border-width: 0;
                      --card-primary-font-size: 15px;
                      --card-secondary-font-size: 14px;
                    }
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.consommation_instantannee_chauffage
                    color: orange
                    smoothing: false
                    aggregate_func: min
                height: 80
                hours_to_show: 24
                points_per_hour: 10
                line_width: 1
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
                card_mod:
                  style: |
                    ha-card {
                      position: absolute !important;
                      
                      width: 80%;
                      right: 0px;
                      bottom: 0px;
                      --ha-card-border-width: 0;
                    }
                    ha-card:after {
                      content: "";
                      position: absolute;
                      width: 100%;
                      height: 100%;
                      'background: linear-gradient(to right, var(--card-background-color), transparent);
                      --ha-card-border-width: 0;
                    }
            card_mod:
              style: |
                ha-card {
                  --ha-card-border-width: 0;
                   --card-primary-font-size: 18px;
                   --card-secondary-font-size: 15px;

                  {% if state_attr('climate.chauffage_salon','hvac_action')=='idle'%}
                   background: linear-gradient(to right, lightblue, blue);
                   {% elif state_attr('climate.chauffage_salon','hvac_action')=='heating'%}
                   background: linear-gradient(to right, orange, red);
                   {% endif %};
                 }
          - type: custom:stack-in-card
            cards:
              - type: custom:mushroom-climate-card
                entity: climate.chauffage_chloe
                fill_container: true
                show_temperature_control: true
                collapsible_controls: false
                hvac_modes:
                  - heat
                  - 'off'
                name: Chloé
                primary_info: name
                secondary_info: state
                icon: mdi:radiator
                tap_action:
                  action: toggle
                grid_options:
                  columns: 12
                  rows: 1
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                        --ha-card-border-width: 0;
                      --card-primary-font-size: 18px;
                      --card-secondary-font-size: 15px;

                     {% if state_attr('climate.chauffage_chloe','hvac_action')=='idle'%}
                      background: linear-gradient(to right, lightblue, blue);
                      {% elif state_attr('climate.chauffage_chloe','hvac_action')=='heating'%}
                      background: linear-gradient(to right, orange, red);
                      {% endif %};
                    }
              - type: custom:mushroom-template-card
                primary: >-
                  Conso Instantannée  : {{states('sensor.chauffage_chloe_power')
                  | float(0) | round(0)}} W 
                secondary: ' Conso journée : {{states(''sensor.kwh_chloe_quotidien'') | float(0) | round(2)}} kWh'
                card_mod:
                  style: |
                    ha-card {
                      z-index: 1;
                      --ha-card-border-width: 0;
                      --card-primary-font-size: 15px;
                      --card-secondary-font-size: 14px;
                    }
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.chauffage_chloe_power
                    color: orange
                    smoothing: false
                    aggregate_func: min
                height: 80
                hours_to_show: 24
                points_per_hour: 10
                line_width: 1
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
                card_mod:
                  style: |
                    ha-card {
                      position: absolute !important;
                      
                      width: 80%;
                      right: 0px;
                      bottom: 0px;
                      --ha-card-border-width: 0;
                    }
                    ha-card:after {
                      content: "";
                      position: absolute;
                      width: 100%;
                      height: 100%;
                      'background: linear-gradient(to right, var(--card-background-color), transparent);
                      --ha-card-border-width: 0;
                    }
            card_mod:
              style: >
                ha-card {

                --ha-card-border-width: 0;
                 --card-primary-font-size: 18px;
                 --card-secondary-font-size: 15px;

                {% if
                state_attr('climate.chauffage_chloe','hvac_action')=='idle'%}
                 background: linear-gradient(to right, lightblue, blue);
                 {% elif state_attr('climate.chauffage_chloe','hvac_action')=='heating'%}
                 background: linear-gradient(to right, orange, red);
                 {% endif %};
                 }
          - type: custom:stack-in-card
            cards:
              - type: custom:mushroom-climate-card
                entity: climate.chauffage_lucie
                fill_container: true
                show_temperature_control: true
                collapsible_controls: false
                hvac_modes:
                  - heat
                  - 'off'
                name: Lucie
                primary_info: name
                secondary_info: state
                icon: mdi:radiator
                tap_action:
                  action: toggle
                grid_options:
                  columns: 12
                  rows: 1
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                        --ha-card-border-width: 0;
                      --card-primary-font-size: 18px;
                      --card-secondary-font-size: 15px;

                     {% if state_attr('climate.chauffage_lucie','hvac_action')=='idle'%}
                      background: linear-gradient(to right, lightblue, blue);
                      {% elif state_attr('climate.chauffage_lucie','hvac_action')=='heating'%}
                      background: linear-gradient(to right, orange, red);
                      {% endif %};
                    }
              - type: custom:mushroom-template-card
                primary: >-
                  Conso Instantannée  : {{states('sensor.chauffage_lucie_power')
                  | float(0) | round(0)}} W 
                secondary: ' Conso journée : {{states(''sensor.kwh_lucie_quotidien'') | float(0) | round(2)}} kWh'
                card_mod:
                  style: |
                    ha-card {
                      z-index: 1;
                      --ha-card-border-width: 0;
                      --card-primary-font-size: 15px;
                      --card-secondary-font-size: 14px;
                    }
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.chauffage_lucie_power
                    color: orange
                    smoothing: false
                    aggregate_func: min
                height: 80
                hours_to_show: 24
                points_per_hour: 10
                line_width: 1
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
                card_mod:
                  style: |
                    ha-card {
                      position: absolute !important;
                      
                      width: 80%;
                      right: 0px;
                      bottom: 0px;
                      --ha-card-border-width: 0;
                    }
                    ha-card:after {
                      content: "";
                      position: absolute;
                      width: 100%;
                      height: 100%;
                      'background: linear-gradient(to right, var(--card-background-color), transparent);
                      --ha-card-border-width: 0;
                    }
            card_mod:
              style: |
                ha-card {
                  --ha-card-border-width: 0;
                   --card-primary-font-size: 18px;
                   --card-secondary-font-size: 15px;

                  {% if state_attr('climate.chauffage_lucie','hvac_action')=='idle'%}
                   background: linear-gradient(to right, lightblue, blue);
                   {% elif state_attr('climate.chauffage_lucie','hvac_action')=='heating'%}
                   background: linear-gradient(to right, orange, red);
                   {% endif %};
                   }
          - type: heading
            icon: mdi:lightning-bolt-outline
            heading: Consommation Appareils
            heading_style: subtitle
            tap_action:
              action: navigate
              navigation_path: /lovelace/chauffage
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      Frigo Garage  : {{states('sensor.garage_power') | float(0)
                      | round(0)}} W 
                    secondary: >-
                      {{(states('sensor.garage_energy') | float(0) /1000) |
                      round(2)}} kWh
                    icon: mdi:lightning-bolt
                    icon_color: >-
                      {%if
                      states('switch.smart_plug_2212201252928451080d48e1e9b58461_outlet')=="on"%}
                      yellow 

                      {%else%} grey

                      {%endif%}
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.garage_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 12
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 80%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      Grand Frigo  : {{states('sensor.grand_frigo_power') |
                      float(0) | round(0)}} W 
                    secondary: >-
                      {{states('sensor.grand_frigo_energie') | float(0) |
                      round(2)}} kWh
                    icon: mdi:lightning-bolt
                    icon_color: |-
                      {%if states('switch.grand_frigo')=="on"%} yellow 
                      {%else%} grey
                      {%endif%}
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.grand_frigo_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 12
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 100%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
          - type: horizontal-stack
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      NAS + Box  : {{states('sensor.garage2_power') | float(0) |
                      round(0)}} W 
                    secondary: >-
                      {{(states('sensor.garage2_energy') | float(0) /1000) |
                      round(2)}} kWh
                    icon: mdi:lightning-bolt
                    icon_color: >-
                      {%if
                      states('switch.smart_plug_2212205215117151080d48e1e9b59f7e_outlet')=="on"%}
                      yellow 

                      {%else%} grey

                      {%endif%}
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.garage2_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 12
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 80%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      Bureau Lucie  : {{states('sensor.bureau_lucie_power') |
                      float(0) | round(0)}} W 
                    secondary: >-
                      {{states('sensor.bureau_lucie') | float(0) | round(2)}}
                      kWh
                    icon: mdi:lightning-bolt
                    icon_color: |-
                      {%if states('switch.bureau_lucie')=="on"%} yellow 
                      {%else%} grey
                      {%endif%}
                    tap_action:
                      action: perform-action
                      perform_action: switch.toggle
                      target:
                        entity_id: switch.bureau_lucie
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.bureau_lucie_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 12
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 100%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
          - type: horizontal-stack
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      TV  : {{states('sensor.tv_power') | float(0) | round(0)}}
                      W 
                    secondary: >-
                      {{(states('sensor.tv_energy') | float(0) / 1000) |
                      round(2)}} kWh
                    icon: mdi:lightning-bolt
                    icon_color: |-
                      {%if states('switch.tv')=="on"%} yellow 
                      {%else%} grey
                      {%endif%}
                    tap_action:
                      action: perform-action
                      perform_action: switch.toggle
                      target:
                        entity_id: switch.tv
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.tv_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 12
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 80%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      Tablette  : {{states('sensor.prise_surface_power') |
                      float(0) | round(0)}} W 
                    secondary: >-
                      {{(states('sensor.prise_surface_energie') | float(0) /
                      1000) | round(2)}} kWh
                    icon: mdi:lightning-bolt
                    icon_color: |-
                      {%if states('switch.prise_surface')=="on"%} yellow 
                      {%else%} grey
                      {%endif%}
                    tap_action:
                      action: perform-action
                      perform_action: switch.toggle
                      target:
                        entity_id: switch.prise_surface
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.prise_surface_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 12
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 80%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
          - type: horizontal-stack
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      Bureau Richard  : {{states('sensor.prise_bureau_power') |
                      float(0) | round(0)}} W 
                    secondary: >-
                      {{states('sensor.prise_bureau') | float(0) | round(2)}}
                      kWh
                    icon: mdi:lightning-bolt
                    icon_color: |-
                      {%if states('switch.prise_bureau')=="on"%} yellow 
                      {%else%} grey
                      {%endif%}
                    tap_action:
                      action: perform-action
                      perform_action: switch.toggle
                      target:
                        entity_id: switch.prise_bureau
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.prise_bureau_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 24
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 100%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
              - type: custom:stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: >-
                      Bureau Axelle  : {{states('sensor.bureau_axelle_power') |
                      float(0) | round(0)}} W 
                    secondary: >-
                      {{states('sensor.bureau_axelle') | float(0) | round(2)}}
                      kWh
                    icon: mdi:lightning-bolt
                    icon_color: |-
                      {%if states('switch.bureau_axelle')=="on"%} yellow 
                      {%else%} grey
                      {%endif%}
                    tap_action:
                      action: perform-action
                      perform_action: switch.toggle
                      target:
                        entity_id: switch.bureau_axelle
                    card_mod:
                      style: |
                        ha-card {
                          z-index: 1;
                          --ha-card-border-width: 0;
                          --card-primary-font-size: 15px;
                          --card-secondary-font-size: 14px;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.bureau_axelle_power
                        color: '#4dfc5a'
                        smoothing: false
                        aggregate_func: min
                    height: 80
                    hours_to_show: 24
                    points_per_hour: 10
                    line_width: 1
                    animate: true
                    show:
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          position: absolute !important;
                          height: 100%;
                          width: 80%;
                          right: 0px;
                          bottom: 0px;
                          --ha-card-border-width: 0;
                        }
                        ha-card:after {
                          content: "";
                          position: absolute;
                          width: 100%;
                          height: 100%;
                          'background: linear-gradient(to right, var(--card-background-color), transparent);
                          --ha-card-border-width: 0;
                        }
                card_mod:
                  style: |
                    ha-card {
                    --ha-card-border-width: 0;
                      }
          - type: heading
            icon: mdi:printer-3d
            heading: Imprimante 3D
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: custom:stack-in-card
            cards:
              - type: custom:mushroom-template-card
                entity: camera.octoprint_camera
                primary: Ender 3 NEO
                secondary: >-
                  {% if is_state('switch.imprimante_3d','off') %} Off

                  {% elif is_state('sensor.octoprint_print_status','Printing')
                  %}
                    {{ (states('sensor.octoprint_print_progress') | round(0) )}}% {{states('sensor.octoprint_print_status')}}
                  {% else %}
                    {{states('sensor.octoprint_print_status')}}
                  {% endif %}       
                icon: mdi:printer-3d
                icon_color: white
                tap_action:
                  action: more-info
                hold_action:
                  action: navigate
                  navigation_path: /lovelace/3d-printer
                card_mod:
                  style:
                    mushroom-shape-icon$: |
                      .shape {
                        background: radial-gradient(var(--card-background-color) 60%, transparent 0%), conic-gradient(rgb(252,109,9) {{ states('sensor.octoprint_print_progress') | round(0) }}% 0%, var(--card-background-color) 0% 100%);
                      }
                      .shape:after {
                        content: "";
                        height: 100%;
                        width: 100%;
                        position: absolute;
                        border-radius: 50%;
                        background: rgba(var(--rgb-{{ config.icon_color }}), 0.1);
                      }
                    .: |
                      ha-card {
                        border: none;
                      }
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    content: >-
                      {{ states('sensor.octoprint_tool_0_temperature') | float
                      }} °C
                    icon: mdi:printer-3d-nozzle-heat
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background: rgba(var(--rgb-{{ config.icon_color }}), 0.1);
                          border: none;
                        }
                  - type: template
                    content: >-
                      {{ states('sensor.octoprint_bed_temperature') | float }}
                      °C
                    icon: mdi:heating-coil
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background: rgba(var(--rgb-{{ config.icon_color }}), 0.1);
                          border: none;
                        }
                  - type: conditional
                    conditions:
                      - condition: state
                        entity: binary_sensor.octoprint_printing
                        state: 'on'
                    chip:
                      type: template
                      content: >-
                        {% set seconds =
                        states('sensor.octoprint_print_time_left') | int %} {{
                        '%02d:%02d:%02d' % (seconds // 3600, (seconds % 3600) //
                        60, seconds % 60) }}
                      icon: mdi:timer-settings
                      card_mod:
                        style: |
                          ha-card {
                            --chip-background: --chip-background: rgba(var(--rgb-{{ config.icon_color }}), 0.1);
                            border: none;
                          }
                  - type: conditional
                    conditions:
                      - condition: state
                        entity: binary_sensor.octoprint_printing
                        state: 'on'
                    chip:
                      type: template
                      content: >-
                        {% set seconds = states('sensor.octoprint_print_time') |
                        int %}
                         {{ '%02d:%02d:%02d' % (seconds // 3600, (seconds % 3600) // 60, seconds % 60) }}
                      icon: mdi:timer-play-outline
                      card_mod:
                        style: |
                          ha-card {
                            --chip-background: --chip-background: rgba(var(--rgb-{{ config.icon_color }}), 0.1);
                          border: none;
                          }
              - type: custom:mushroom-chips-card
                chips:
                  - type: entity
                    entity: sensor.imprimante_3d_power
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background: rgba(var(--rgb-{{ config.icon_color }}), 0.1);
                          border: none;
                        }
                  - type: entity
                    entity: sensor.imprimante_3d_conso
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background: rgba(var(--rgb-{{ config.icon_color }}), 0.1);
                          border: none;
                        }
              - type: custom:mushroom-chips-card
                chips:
                  - type: entity
                    entity: switch.imprimante_3d
                    icon_color: black
                    icon: mdi:power
                    content_info: none
                    tap_action:
                      action: toggle
                    card_mod:
                      style: |
                        ha-card {
                           {%if states('switch.imprimante_3d')=="on"%}
                           --chip-background: orange;
                           {%else%}--chip-background: white;{%endif%}
                          
                          --icon-color: black;
                        } 
                  - type: entity
                    entity: switch.octoprint_pause_print
                    icon_color: white
                    icon: mdi:pause
                    content_info: none
                    tap_action:
                      action: toggle
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background: rgba(var({{ '--rgb-grey' }}), 0.7);
                          --icon-color: rgb(var(--rgb-white));
                        } 
                  - type: entity
                    entity: button.octoprint_cancel_print
                    icon_color: white
                    icon: mdi:stop
                    content_info: none
                    tap_action:
                      action: toggle
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background: rgba(var({{ '--rgb-red' }}), 1);
                        } 
                card_mod:
                  style: |
                    ha-card {
                        --chip-box-shadow: none;
                        top: 16px;
                        width: -webkit-fill-available;
                        right: 12px;
                        position: absolute;
                    } 
                    .chip-container {
                        right: 0px;
                        position: absolute;
                    }type: ""
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-lightning-bolt
            heading: Tempo EDF
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.rte_tempo_couleur_actuelle_visuel
                icon: mdi:flash
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                    if (states['sensor.rte_tempo_couleur_actuelle'].state === "Rouge") {
                      return '<div style="background-color: rgba(255, 100, 100, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<b>Aujourd hui</b></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <img src="https://raw.githubusercontent.com/Axelle78/test/master/panneau.png" width="10%" height="10%"> <br/> ' +
                             states["sensor.prix_actuel"].state + ' <br />-';
                    } else if (states['sensor.rte_tempo_couleur_actuelle'].state === "Blanc") {
                      return '<div style="background-color: rgba(200, 200, 200, 01); border-radius: 15px; padding: 10px; display: inline-block; text-align: center; color: black;">' +
                             '<b>Aujourd hui</b></div><hr width="150" size="1" align="center" color="#000000"></hr> <img src="https://raw.githubusercontent.com/Axelle78/test/master/OK.png" width="10%" height="10%"> <br/> ' +
                             states["sensor.prix_actuel"].state + ' <br />-';
                    } else {
                      return '<div style="background-color: rgba(100, 100, 255, 1); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;">' +
                             '<b>Aujourd hui</b></div><hr width="150" size="1" align="center" color="#FFFFFF"></hr> <img src="https://raw.githubusercontent.com/Axelle78/test/master/OK.png" width="10%" height="10%"> <br/> ' +
                             states["sensor.prix_actuel"].state + ' <br />-';
                    }
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     {%if states('sensor.rte_tempo_couleur_actuelle')=="Rouge" %}
                     background-color: red;
                     {%elif states('sensor.rte_tempo_couleur_actuelle')=="Bleu" %}
                      background-color: blue;
                      {%else%}
                      background-color: white;
                      color: black;
                      {%endif%}
                    } 
              - type: custom:button-card
                entity: sensor.prix_actuel
                label: |
                  [[[
                    
                    if(states['sensor.rte_tempo_prochaine_couleur'].state=="Rouge")
                      return '<div style="background-color: rgba(255, 100, 100, 1); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;"><b>Demain</b></div><hr width="150" size="1" align=center color ="#FFFFFF"></hr> <img src="https://raw.githubusercontent.com/Axelle78/test/master/panneau.png" width=10% height=10% > <br/> HP ' + states['sensor.tarif_jour_rouge_hp'].state + '<BR>HC ' +states['sensor.tarif_jour_rouge_hc'].state
                    else if(states['sensor.rte_tempo_prochaine_couleur'].state=="Bleu")
                      return '<div style="background-color: rgba(100, 100, 255, 1); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;"><b>Demain</b></div><hr width="150" size="1" align=center color ="#FFFFFF"></hr> <img src="https://raw.githubusercontent.com/Axelle78/test/master/OK.png" width=10% height=10% > <br/>HP ' + states['sensor.tarif_jour_bleu_hp'].state + '<BR>HC ' +states['sensor.tarif_jour_bleu_hc'].state
                    else if(states['sensor.rte_tempo_prochaine_couleur'].state=="Blanc")
                      return '<div style="background-color:  rgba(200, 200, 200, 1); border-radius: 15px; padding: 10px; display: inline-block; text-align: center;"><b>Demain</b></div><hr width="150" size="1" align=center color ="#00000"></hr> <img src="https://raw.githubusercontent.com/Axelle78/test/master/OK.png" width=10% height=10% > <br/>HP ' + states['sensor.tarif_jour_blanc_hp'].state + '<BR>HC ' +states['sensor.tarif_jour_blanc_hc'].state    
                    else
                      return 'Information indisponible'
                    endif  
                   
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     {%if states('sensor.rte_tempo_prochaine_couleur')=="Rouge" %}
                     background-color: red;
                     {%elif states('sensor.rte_tempo_prochaine_couleur')=="Bleu" %}
                      background-color: blue;
                      {%elif states('sensor.rte_tempo_prochaine_couleur')=="Blanc" %}
                      background-color: white;
                      color: black;
                      {%else%}
                      background-color: grey;
                      color: white;
                      {%endif%}
                    } 
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: sensor.cout_tempo_jour_total
                label: |
                  [[[
                     var label = ""
                      label = '<b>Rouge</b><hr width="100" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.rte_tempo_cycle_jours_restants_rouge'].state + '/'  + states['sensor.nb_jours_rouge_total'].state + '<br>HP ' + states['sensor.tarif_jour_rouge_hp'].state + '<BR>'+'HC ' + states['sensor.tarif_jour_rouge_hc'].state
                      return label;
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     background-color: red;

                    } 
              - type: custom:button-card
                entity: sensor.cout_tempo_jour_total
                label: |
                  [[[
                     var label = ""
                      label = '<b>Blanc</b><hr width="100" size="1" align=center color ="#00000"></hr>' + states['sensor.rte_tempo_cycle_jours_restants_blanc'].state + '/'  + states['sensor.nb_jours_blanc_total'].state + '<br>HP ' + states['sensor.tarif_jour_blanc_hp'].state + '<BR>'+'HC ' + states['sensor.tarif_jour_blanc_hc'].state
                      return label;
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     color: black;
                     background-color: white;

                    } 
              - type: custom:button-card
                entity: sensor.cout_tempo_jour_total
                label: |
                  [[[
                     var label = ""
                      label = '<b>Bleu</b><hr width="100" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.rte_tempo_cycle_jours_restants_bleu'].state + '/'  + states['sensor.nb_jours_bleu_total'].state + '<br>HP ' + states['sensor.tarif_jour_bleu_hp'].state + '<BR>'+'HC ' + states['sensor.tarif_jour_bleu_hc'].state
                      return label;
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     background-color: blue;

                    } 
          - type: heading
            icon: mdi:lightning-bolt-circle
            heading: Données ecojoko
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: sensor.cout_tempo_jour_total
                label: |
                  [[[
                     if(states['sensor.evol_cout_hier'].state<0)
                      return  '<b>Coûts</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.cout_tempo_jour_total'].state + ' € <br>' + states['sensor.evol_cout_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_dim.png" width=15% height=20% >' 
                     else
                       return  '<b>Coûts</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.cout_tempo_jour_total'].state + ' € <br>' + states['sensor.evol_cout_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_aug.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi des coûts sur 24h
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.cout_tempo_jour_total
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Côuts EDF
                          entities:
                            - sensor.cout_tempo_jour_total
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     padding-top: 5px;
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
              - type: custom:button-card
                entity: sensor.conso_tempo_jour_total
                label: |
                  [[[
                     if(states['sensor.evol_conso_hier'].state<0)
                      return  '<b>Conso</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.conso_tempo_jour_total'].state + ' kWh <br>' + states['sensor.evol_conso_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_dim.png" width=15% height=20% >'
                     else
                       return '<b>Conso</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.conso_tempo_jour_total'].state + ' kWh <br>' + states['sensor.evol_conso_hier'].state + ' % <br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_aug.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi de la consommation
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.conso_tempo_jour_total
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Conso EDF
                          entities:
                            - sensor.conso_tempo_jour_total
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
              - type: custom:button-card
                entity: sensor.prodution_kwh
                label: |
                  [[[
                     if(states['sensor.evol_production_hier'].state>0)
                      return  '<b>Production</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.prodution_kwh'].state + ' kWh <br>' + states['sensor.evol_production_hier'].state + ' %<br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_vert_aug.png" width=15% height=20% >'
                     else
                       return '<b>Production</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.prodution_kwh'].state + ' kWh <br>' + states['sensor.evol_production_hier'].state + ' %<br>' + '<img src="https://raw.githubusercontent.com/Axelle78/test/master/fleche_rouge_dim.png" width=15% height=20% >'
                     endif
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi de la production
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.prodution_kwh
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Production Panneaux
                          entities:
                            - sensor.prodution_kwh
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
              - type: custom:button-card
                entity: sensor.ecojoko_surplus_de_production
                label: |
                  [[[
                     var label = ""
                      label = '<b>Export</b><hr width="70" size="1" align=center color ="#FFFFFF"></hr>' + states['sensor.ecojoko_surplus_de_production'].state + ' kWh <br>' + states['sensor.surplus_edf'].state + ' € <br><br>' 
                      return label;
                  ]]]
                show_label: true
                show_icon: false
                show_state: false
                show_name: false
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      browser_id: THIS
                      size: normal
                      title: Suivi du surplus de production
                      content:
                        type: custom:config-template-card
                        entities:
                          - sensor.ecojoko_surplus_de_production
                        card:
                          type: custom:mini-graph-card
                          animate: true
                          name: Surplus Panneaux
                          entities:
                            - sensor.ecojoko_surplus_de_production
                          labels: true
                          font_size: 60
                          line_color: green
                          points_per_hour: 6
                          hours_to_show: >-
                            ${

                            var date = new Date();

                            var curHour = date.getHours() +
                            (date.getMinutes()/60.0)-1 +
                            date.getSeconds()/3600.0;

                            curHour

                            }
                          height: 100
                          show:
                            labels: true
                card_mod:
                  style: |
                    ha-card {
                     border-radius:10px; 
                     box-shadow: 
                     {%- set couleur= states('sensor.rte_tempo_couleur_actuelle') %}
                     {%- if couleur=='Bleu' %} 0px 0px 10px 3px rgba(50,130,246)  
                     {%- elif couleur=='Blanc' %} 0px 0px 10px 3px rgba(246,246,246)
                     {%- elif couleur=='Rouge' %} 0px 0px 10px 3px rgba(246,47,8)
                     {%- else %} 0px 0px 10px 3px rgba(195,195,195)
                     {%- endif %}
                    } 
          - type: heading
            icon: mdi:solar-power
            heading: Panneaux solaire
            heading_style: subtitle
            tap_action:
              action: navigate
              navigation_path: /lovelace/10
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: custom:power-distribution-card
            entities:
              - decimals: '0'
                display_abs: true
                name: solar
                unit_of_display: W
                icon: mdi:solar-power
                producer: true
                entity: sensor.envoy_122250004672_current_power_production
                preset: solar
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
              - decimals: '0'
                display_abs: true
                name: Export
                unit_of_display: W
                icon: mdi:lightning-bolt-outline
                producer: true
                entity: sensor.energy_exporting
                preset: producer
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
                calc_excluded: true
              - decimals: '0'
                display_abs: true
                name: conso
                unit_of_display: W
                consumer: true
                icon: mdi:home
                entity: sensor.envoy_122250004672_current_power_consumption
                preset: consumer
                icon_color:
                  bigger: red
                  equal: green
                  smaller: red
                invert_value: true
              - decimals: '0'
                display_abs: true
                name: Import
                unit_of_display: W
                icon: mdi:transmission-tower
                entity: sensor.energy_importing
                preset: grid
                icon_color:
                  bigger: red
                  equal: gray
                  smaller: red
                invert_value: true
            center:
              type: bars
              content:
                - preset: ratio
                  name: use
                  bar_color: green
                  bar_bg_color: ''
                  entity: ''
                  invert_value: false
                - preset: autarky
                  name: indep
                  bar_color: blue
            animation: flash
            card_mod:
              style: |
                ha-card .title {
                  font-size: 12px;
                }
          - type: heading
            icon: mdi:dishwasher
            heading: Electroménager
            heading_style: subtitle
            card_mod:
              style: |
                ha-card.type-heading {
                  --ha-heading-card-subtitle-font-size: 20px !important;
                  --ha-heading-card-subtitle-font-weight: 400;
                  padding: 12px;
                  }
          - type: horizontal-stack
            cards:
              - type: tile
                name: Etat Lave-Vaisselle
                icon: mdi:dishwasher
                entity: sensor.lave_vaisselle_operation_state
                features_position: bottom
                vertical: true
              - type: tile
                entity: sensor.lave_vaisselle_door
                name: Porte
                features_position: bottom
                vertical: true
              - type: tile
                entity: sensor.progression_lave_vaisselle
                icon: mdi:percent
                name: Progression
                features_position: bottom
                vertical: true
          - type: entities
            entities:
              - type: divider
            card_mod:
              style: |
                ha-card {
                   
                   border-width: 0px;

                   background: none;
                  }
          - type: horizontal-stack
            cards:
              - type: tile
                name: Etat Four
                icon: mdi:stove
                features_position: bottom
                vertical: true
                entity: sensor.four_job_state
              - type: tile
                name: T° Voulue
                icon: mdi:thermometer-check
                features_position: bottom
                vertical: true
                entity: sensor.four_setpoint
              - type: tile
                icon: mdi:thermometer-lines
                name: T° Actuelle
                features_position: bottom
                vertical: true
                entity: sensor.four_temperature
    badges:
      - type: custom:mushroom-template-badge
        content: '{{states("sensor.poubelle_j")}}'
        icon: >-
          {% if states("sensor.poubelle_j")=="Pas de poubelle aujourd'hui" %} 
          mdi:trash-can-outline
           
          {%else%} mdi:trash-can {%endif%}
        color: >-
          {% if states("sensor.poubelle_j")=="Pas de poubelle aujourd'hui" %} 
          green 

          {% elif states("sensor.poissy_mantes")<"45:00" %}  orange 

          {%else%} red {%endif%}
        tap_action:
          action: more-info
        entity: sensor.poubelle_j
      - type: custom:mushroom-template-badge
        content: '{{states("sensor.poubelle_j1")}}'
        icon: >-
          {% if states("sensor.poubelle_j1")=="Pas de poubelle demain" %} 
          mdi:trash-can-outline
           
          {%else%} mdi:trash-can {%endif%}
        color: >-
          {% if states("sensor.poubelle_j1")=="Pas de poubelle demain" %} 
          green 

          {%else%} red {%endif%}
        tap_action:
          action: more-info
        entity: sensor.poubelle_j
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: sensor.anniversaire
        icon: mdi:cake-variant
        color: ''
        visibility:
          - condition: state
            entity: sensor.anniversaire
            state_not: Aucun anniversaire aujourd'hui
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: input_select.camera
        color: ''
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: input_boolean.summer_mode
        color: ''
      - type: entity
        show_name: false
        show_state: true
        show_icon: true
        entity: sensor.indoor_pluie_precipitation_aujourd_hui
        color: ''
        visibility:
          - condition: numeric_state
            entity: sensor.indoor_pluie_precipitation_aujourd_hui
            above: 0
        tap_action:
          action: navigate
          navigation_path: /lovelace/3
      - type: custom:mushroom-template-badge
        content: '{{states("sensor.mantes_poissy")}} minutes'
        icon: mdi:car
        color: |-
          {% if states("sensor.mantes_poissy")<"30:00" %}  green 
          {% elif states("sensor.mantes_poissy")<"45:00" %}  orange 
          {%else%} red {%endif%}
        label: Mantes-Poissy
        tap_action:
          action: more-info
        entity: sensor.mantes_poissy
      - type: custom:mushroom-template-badge
        content: '{{states("sensor.poissy_mantes")}} minutes'
        icon: mdi:car
        color: |-
          {% if states("sensor.poissy_mantes")<"30:00" %}  green 
          {% elif states("sensor.poissy_mantes")<"45:00" %}  orange 
          {%else%} red {%endif%}
        label: Poissy-Mantes
        tap_action:
          action: more-info
        entity: sensor.poissy_mantes
      - type: custom:mushroom-template-badge
        content: '{{states(''sensor.batterie_surface'')}} %'
        icon: |2-
            {% if states('sensor.batterie_surface') | float <= 20 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-20
            {% elif states('sensor.batterie_surface') | float <= 30 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-30
            {% elif states('sensor.batterie_surface') | float <= 40 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-40
            {% elif states('sensor.batterie_surface') | float <= 50 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-50
            {% elif states('sensor.batterie_surface') | float <= 60 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-60
            {% elif states('sensor.batterie_surface') | float <= 70 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-70
            {% elif states('sensor.batterie_surface') | float <= 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery-80
            {% elif states('sensor.batterie_surface') | float > 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Offline" %} mdi:battery
            {% elif states('sensor.batterie_surface') | float < 30 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-30
            {% elif states('sensor.batterie_surface') | float <= 40 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-40
            {% elif states('sensor.batterie_surface') | float <= 50 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-50
            {% elif states('sensor.batterie_surface') | float <= 60 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-60
            {% elif states('sensor.batterie_surface') | float <= 70 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-70
            {% elif states('sensor.batterie_surface') | float <= 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-80
            {% elif states('sensor.batterie_surface') | float > 80 and  states('sensor.tv_tablette_batterie_powerline_status')=="Online" %} mdi:battery-charging-100

            {%endif%}
        color: >-
          {% if states('ensor.tv_tablette_batterie_powerline_status')=="Online"
          %} green


          {% elif states('sensor.batterie_surface') | float < 30 %} red

          {% elif states('sensor.batterie_surface') | float < 50 %} orange

          {%else%} green

          {%endif%}
        label: Tablette
        tap_action:
          action: more-info
        entity: sensor.batterie_surface
      - type: custom:mushroom-template-badge
        content: '{{ states(''sensor.four_temperature'') }} °C'
        icon: mdi:thermometer
        color: |-
          {% if states('sensor.four_job_state')=="preheat" %} orange
          {%elif states('sensor.four_job_state')=="cooking" %}
          green
          {%else%}
          blue
          {%endif%}
        label: Four
        visibility:
          - condition: state
            entity: sensor.four_job_state
            state_not: ready
      - type: custom:mushroom-template-badge
        content: >-
          {% if states('binary_sensor.fenetre_chambre_contact')=="on"%} |
          Chambre {%endif%}

          {% if states('binary_sensor.fenetre_lucie_contact')=="on"%}  | Lucie
          {%endif%}

          {% if states('binary_sensor.fenetre_chloe_contact')=="on"%} | Chloé
          {%endif%} |
        icon: mdi:window-open-variant
        color: green
        visibility:
          - condition: state
            entity: sensor.nb_fenetres_ouvertes
            state_not: '0'
        label: |2
            {% if states('sensor.nb_fenetres_ouvertes') |float ==1 %}
            1 fenêtre ouverte 
            {% else %}
            {{states('sensor.nb_fenetres_ouvertes')}} fenêtres ouvertes
            {%endif%}
    max_columns: 4
    cards: []
    dense_section_placement: false
    header:
      layout: center
      badges_position: bottom
    visible:
      - user: 9bd2c79bb7c44dd79f5b1aaf38d12367
  - icon: mdi:lightbulb
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-light-card
                entity: light.go2
                fill_container: true
                use_light_color: true
                show_brightness_control: true
                show_color_temp_control: true
                show_color_control: true
                collapsible_controls: true
              - type: custom:mushroom-light-card
                entity: light.awtrix_1e818c_matrix
                fill_container: false
                use_light_color: false
                show_brightness_control: false
                show_color_temp_control: false
                show_color_control: false
                collapsible_controls: false
                name: Ecran Awtrix
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-light-card
                entity: light.lampe
                fill_container: true
                show_brightness_control: true
                show_color_control: true
                show_color_temp_control: true
                use_light_color: true
                collapsible_controls: true
              - type: custom:mushroom-light-card
                entity: light.couloir
                fill_container: false
                use_light_color: true
                show_brightness_control: true
                show_color_temp_control: true
                show_color_control: true
                collapsible_controls: true
          - type: custom:mushroom-light-card
            entity: light.bureau_chloe
            fill_container: true
            show_brightness_control: true
            use_light_color: false
            show_color_temp_control: true
          - type: custom:mushroom-light-card
            entity: light.lampe_chloe
            fill_container: true
            show_brightness_control: true
            use_light_color: false
            show_color_temp_control: true
      - type: vertical-stack
        cards:
          - type: custom:mushroom-light-card
            fill_container: true
            entity: light.led_chloe
            use_light_color: true
            show_brightness_control: true
            show_color_temp_control: true
            show_color_control: true
            collapsible_controls: true
            name: LED Chloé
          - type: entities
            entities:
              - entity: switch.led_chloe_audio
              - entity: select.led_chloe_audio_effect
              - entity: select.led_chloe_audio_sensitivity
              - entity: input_number.mode_led_chloe
              - entity: number.led_chloe_speed
      - type: horizontal-stack
        cards:
          - type: vertical-stack
            cards:
              - type: custom:mushroom-light-card
                fill_container: true
                entity: light.led
                use_light_color: true
                show_brightness_control: true
                show_color_temp_control: true
                show_color_control: true
                collapsible_controls: true
                name: LED Lucie
              - type: entities
                entities:
                  - entity: switch.led_audio
                  - entity: select.led_audio_effect
                  - entity: select.led_audio_sensitivity
                  - entity: input_number.mode_led_lucie
                  - entity: number.led_speed
      - type: vertical-stack
        cards:
          - type: custom:mushroom-light-card
            fill_container: true
            entity: light.led_lucie
            use_light_color: true
            show_brightness_control: true
            show_color_temp_control: true
            show_color_control: true
            collapsible_controls: true
            name: LED Lit Lucie
          - type: entities
            entities:
              - entity: switch.led_lucie_audio
              - entity: select.led_lucie_audio_effect
              - entity: select.led_lucie_audio_sensitivity
              - entity: input_number.mode_led_lit
              - entity: number.led_lucie_speed
    type: custom:horizontal-layout
  - type: sections
    max_columns: 3
    title: Statistics
    path: statistics
    icon: mdi:chart-box-outline
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:solar-power-variant
            heading: Durée de production
            heading_style: subtitle
          - type: custom:stack-in-card
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.mode_solaire_duree
                    primary_info: state
                    secondary_info: name
                    name: Durée production
                    icon: mdi:timer
                  - type: custom:mushroom-template-card
                    primary: >-
                      {%if
                      states('sensor.production')=="solaire"%}{{states('sensor.debut_production_2')}}{%else%}{{states('input_text.derniere_heure_fin_production')}}{%endif%}
                    secondary: >-
                      {%if states('sensor.production')=="solaire"%}Heure début
                      solaire {%else%}Heure fin solaire{%endif%}
                    icon: >-
                      {%if
                      states('sensor.production')=="solaire"%}mdi:solar-power{%else%}
                      mdi:transmission-tower{%endif%}
                    icon_color: >-
                      {%if
                      states('sensor.production')=="solaire"%}yellow{%else%}
                      red{%endif%}
                card_mod:
                  style: |
                    ha-card {
                       margin: -15px -15px -15px -15px;
                       border-width: 0px;
                       --stack-card-gap: 0; 
                      }
              - type: custom:apexcharts-card
                graph_span: 7d
                span:
                  end: day
                apex_config:
                  chart:
                    height: 300px
                    fontFamily: Raleway,sans-serif
                  legend:
                    show: false
                experimental:
                  color_threshold: true
                  brush: true
                header:
                  show: false
                  title: Server Rack
                  show_states: false
                  colorize_states: true
                yaxis:
                  - id: first
                    decimals: 1
                    apex_config:
                      tickAmount: 2
                      stroke:
                        width: 1
                    min: 0
                  - id: second
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 2
                      stroke:
                        width: 1
                      fill:
                        type:
                          - gradient
                        gradient:
                          type: vertical
                          opacityFrom: 0.6
                          opacityTo: 0.1
                series:
                  - entity: sensor.mode_solaire_duree
                    name: Power
                    yaxis_id: first
                    show:
                      legend_value: false
                      datalabels: true
                    type: column
                    group_by:
                      func: last
                      duration: 1d
                card_mod:
                  style: |
                    ha-card {
                       margin: -20px -1px -1px -1px;
                       border-width: 0px;
                       --stack-card-gap: 0; 
                      }
      - type: grid
        cards:
          - type: heading
            icon: mdi:flash
            heading: Suivi consommation journée
            heading_style: subtitle
          - type: custom:stack-in-card
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.ecojoko_consommation_temps_reel
                    primary_info: state
                    secondary_info: name
                    name: Conso live
                    icon: mdi:flash-outline
                  - type: custom:mushroom-entity-card
                    entity: sensor.ecojoko_consommation_reseau
                    primary_info: state
                    secondary_info: name
                    name: Conso jour
                    icon: mdi:flash-outline
                card_mod:
                  style: |
                    ha-card {
                       margin: -15px -15px -15px -15px;
                       border-width: 0px;
                       --stack-card-gap: 0; 
                      }
              - type: custom:apexcharts-card
                graph_span: 1d
                span:
                  start: day
                apex_config:
                  chart:
                    height: 300px
                    fontFamily: Raleway,sans-serif
                  legend:
                    show: false
                experimental:
                  color_threshold: true
                  brush: true
                header:
                  show: false
                  title: Server Rack
                  show_states: false
                  colorize_states: true
                yaxis:
                  - id: first
                    decimals: 1
                    apex_config:
                      tickAmount: 2
                      stroke:
                        width: 1
                  - id: second
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 2
                      stroke:
                        width: 1
                      fill:
                        type:
                          - gradient
                        gradient:
                          type: vertical
                          opacityFrom: 0.6
                          opacityTo: 0.1
                series:
                  - entity: sensor.ecojoko_consommation_temps_reel
                    name: Power
                    yaxis_id: first
                    show:
                      legend_value: false
                    type: column
                    group_by:
                      func: avg
                      duration: 2min
                    color_threshold:
                      - value: -5000
                        color: lightblue
                      - value: 0
                        color: rgb(165,255,132)
                      - value: 1000
                        color: green
                      - value: 2000
                        color: rgb(234, 255, 132)
                      - value: 3000
                        color: orange
                card_mod:
                  style: |
                    ha-card {
                       margin: -20px -1px -1px -1px;
                       border-width: 0px;
                       --stack-card-gap: 0; 
                      }
      - type: grid
        cards:
          - type: heading
            icon: mdi:flash
            heading: Suivi consommation hebdomadaire
            heading_style: subtitle
          - type: custom:apexcharts-card
            stacked: true
            graph_span: 7d
            span:
              end: day
            apex_config:
              legend:
                show: false
              chart:
                height: 345px
            series:
              - entity: sensor.abonnement_edf_journalier
                type: column
                color: rgb(7,142,2)
                group_by:
                  func: last
                  duration: 1d
              - entity: sensor.cout_tempo_jour_blanc_hc
                type: column
                color: rgb(170,170,170)
                group_by:
                  func: last
                  duration: 1d
              - entity: sensor.cout_tempo_jour_blanc_hp
                type: column
                color: rgb(128,128,128)
                group_by:
                  func: last
                  duration: 1d
                show:
                  datalabels: total
              - entity: sensor.cout_tempo_jour_rouge_hp
                type: column
                color: rgb(255,0,0)
                group_by:
                  func: last
                  duration: 1d
                show:
                  datalabels: total
              - entity: sensor.cout_tempo_jour_rouge_hc
                type: column
                color: rgb(255,141,126)
                group_by:
                  func: last
                  duration: 1d
              - entity: sensor.cout_tempo_jour_bleu_hp
                type: column
                color: rgb(63,72,204)
                group_by:
                  func: last
                  duration: 1d
                show:
                  datalabels: total
              - entity: sensor.cout_tempo_jour_bleu_hc
                type: column
                color: rgb(113,155,255)
                group_by:
                  func: last
                  duration: 1d
      - type: grid
        cards:
          - type: heading
            heading: Suivi production de la journée
            heading_style: title
            icon: mdi:solar-power-variant
            badges: []
          - type: horizontal-stack
            cards:
              - type: custom:apexcharts-card
                stacked: true
                graph_span: 1d
                span:
                  end: day
                apex_config:
                  legend:
                    show: false
                  chart:
                    height: 500px
                  xaxis:
                    type: datetime
                    min: 1741561200000
                    max: 1741647600000
                  yaxis:
                    max: 4
                series:
                  - entity: sensor.production_horaire_kwh
                    type: column
                    color: rgb(7, 142, 2)
                    group_by:
                      func: last
                      duration: 1h
                  - entity: sensor.solcast_pv_forecast_previsions_pour_aujourd_hui
                    type: area
                    opacity: 0.3
                    stroke_width: 0
                    color: rgb(170, 170, 170)
                    group_by:
                      func: last
                      duration: 1h
                    show:
                      in_header: false
                    data_generator: |
                      return entity.attributes.detailedForecast.map(d => {
                        return [new Date(d.period_start).getTime(), d.pv_estimate];
                      });
                  - entity: sensor.solcast_pv_forecast_previsions_pour_aujourd_hui
                    type: area
                    stroke_width: 0
                    color: rgb(170, 170, 170)
                    opacity: 0.3
                    group_by:
                      func: last
                      duration: 1h
                    show:
                      in_header: false
                    data_generator: |
                      return entity.attributes.detailedForecast.map(d => {
                        return [new Date(d.period_start).getTime(), d.pv_estimate10];
                      });
            grid_options:
              columns: 21
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:apexcharts-card
                stacked: true
                graph_span: 1week
                span:
                  end: week
                apex_config:
                  legend:
                    show: false
                  chart:
                    height: 500px
                  xaxis:
                    type: datetime
                    min: 1741561200000
                    max: 1741647600000
                  yaxis:
                    max: 35000
                series:
                  - entity: sensor.envoy_122250004672_today_s_energy_production
                    type: column
                    color: rgb(7, 142, 2)
                    group_by:
                      func: last
                      duration: 1d
            grid_options:
              columns: 15
              rows: auto
        column_span: 3
    cards: []
  - type: sections
    max_columns: 1
    icon: mdi:remote-tv
    path: ''
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Ampli
            heading_style: title
            icon: mdi:amplifier
          - show_name: true
            show_icon: true
            type: button
            tap_action:
              action: toggle
            entity: script.allumer_l_ampli
            icon: mdi:power
          - show_name: true
            show_icon: true
            type: button
            tap_action:
              action: toggle
            entity: script.eteindre_l_ampli
            icon: mdi:power-off
          - show_name: true
            show_icon: true
            type: button
            tap_action:
              action: toggle
            entity: script.monter_le_son
            icon: mdi:volume-plus
          - show_name: true
            show_icon: true
            type: button
            tap_action:
              action: toggle
            entity: script.baisser_le_son
            icon: mdi:volume-minus
    cards: []
  - title: dqsdq
    path: dqsdq
    cards:
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Salon</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.salon_temperature
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.humidite_salon
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.salon_temperature
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.humidite_salon
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.salon_temperature
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.humidite_salon
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Dehors</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.indoor_exterieur_temperature
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.indoor_exterieur_humidite
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.indoor_exterieur_temperature
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.indoor_exterieur_humidite
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 5
                  - color: '#1bfd1b'
                    value: 10
                  - color: '#fdf31b'
                    value: 15
                  - color: '#fda41b'
                    value: 20
                  - color: '#fd331b'
                    value: 25
                entities:
                  - sensor.indoor_exterieur_temperature
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.indoor_exterieur_humidite
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Terrasse</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp_terrasse_temperature
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp_terrasse_humidity
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.temp_terrasse_temperature
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 18px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.temp_terrasse_humidity
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 18px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 5
                  - color: '#1bfd1b'
                    value: 10
                  - color: '#fdf31b'
                    value: 15
                  - color: '#fda41b'
                    value: 20
                  - color: '#fd331b'
                    value: 25
                entities:
                  - sensor.temp_terrasse_temperature
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.temp_terrasse_humidity
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Salle de bain</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_temperature_temperature_sdb
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_humidity_temperature_sdb
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_temperature_temperature_sdb
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_humidity_temperature_sdb
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.ble_temperature_temperature_sdb
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.ble_humidity_temperature_sdb
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Chambre</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_temperature_temperature_chambre
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_humidity_temperature_chambre
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_temperature_temperature_chambre
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_humidity_temperature_chambre
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.ble_temperature_temperature_chambre
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.ble_humidity_temperature_chambre
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Lucie</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_temperature_temperature_chambre_de_lucie
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_humidity_temperature_chambre_de_lucie
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_temperature_temperature_chambre_de_lucie
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_humidity_temperature_chambre_de_lucie
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.ble_temperature_temperature_chambre_de_lucie
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.ble_humidity_temperature_chambre_de_lucie
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Chloé</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_temperature_temperature_chambre_chloe
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_humidity_temperature_chambre_chloe
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_temperature_temperature_chambre_chloe
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_humidity_temperature_chambre_chloe
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.ble_temperature_temperature_chambre_chloe
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.ble_humidity_temperature_chambre_chloe
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Garage</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp1_temperature
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp1_humidity
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.temp1_temperature
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.temp1_humidity
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.temp1_temperature
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.temp1_humidity
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Grenier</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp3_temperature
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp3_humidity
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.temp3_temperature
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.temp3_humidity
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.temp3_temperature
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.temp3_humidity
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Cave à vin</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp_cave_a_vin_temperature
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temp_cave_a_vin_humidity
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.temp_cave_a_vin_temperature
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.temp_cave_a_vin_humidity
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.temp_cave_a_vin_temperature
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.temp_cave_a_vin_humidity
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Frigo</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_temperature_cabane
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.ble_humidity_cabane
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_temperature_cabane
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.ble_humidity_cabane
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.ble_temperature_cabane
                labels: true
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.ble_humidity_cabane
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Tortue</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.temperature_tortue
                    color: green
                    max: 50
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -90
                      endAngle: 90
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.humidite_tortue
                    color: '#04FEF3'
                    max: 100
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 100
                      startAngle: 90
                      endAngle: 270
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 80%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: true
                      gradientToColors:
                        - '#0408FE'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -242px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.temperature_tortue
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 35%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
              - type: custom:mushroom-entity-card
                entity: sensor.humidite_tortue
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: blue
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 50%;
                      left : 25%;
                       }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 5
                  - color: '#1bfd1b'
                    value: 10
                  - color: '#fdf31b'
                    value: 15
                  - color: '#fda41b'
                    value: 20
                  - color: '#fd331b'
                    value: 25
                entities:
                  - sensor.temperature_tortue
                height: 130
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
              - animate: true
                color_thresholds:
                  - color: '#F6FE04'
                    value: 20
                  - color: '#04FEFE'
                    value: 30
                  - color: '#049FFE'
                    value: 50
                  - color: '#0441FE'
                    value: 60
                  - color: '#002FBF'
                    value: 70
                entities:
                  - sensor.humidite_tortue
                labels: true
                height: 130
                line_color: blue
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
              - animate: true
                entities:
                  - sensor.soleil_tortue_illuminance
                labels: true
                height: 130
                line_color: yellow
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: '%'
                type: custom:mini-graph-card
      - type: horizontal-stack
        cards:
          - type: custom:stack-in-card
            cards:
              - type: markdown
                content: <center>Congélateur</center>
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.congelateur_temperature
                    color: green
                    max: -15
                    min: -20
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: 0
                      endAngle: 360
                      hollow:
                        size: 80%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: dark
                      type: horizontal
                      shadeIntensity: 0.5
                      inverseColors: false
                      gradientToColors:
                        - '#DCFE04'
                        - '#FEEF04'
                        - '#FEB204'
                        - '#FE4404'
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 100
                  legend:
                    show: false
                  chart:
                    height: 220
                card_mod:
                  style: |
                    ha-card {
                    margin-top: -30px;
                     }
              - type: custom:mushroom-entity-card
                entity: sensor.congelateur_temperature
                primary_info: state
                secondary_info: none
                name: Salon
                icon_color: green
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      position: absolute;
                      top: 45%;
                      left : 25%;
                     }
                    :host {
                     --card-primary-font-size: 16px !important;
                     --mush-icon-size: 25px; 
                    }
          - type: vertical-stack
            cards:
              - animate: true
                color_thresholds:
                  - color: '#1bc6fd'
                    value: 18
                  - color: '#1bfd1b'
                    value: 20
                  - color: '#fdf31b'
                    value: 22
                  - color: '#fda41b'
                    value: 25
                  - color: '#fd331b'
                    value: 30
                entities:
                  - sensor.congelateur_temperature
                labels: true
                height: 350
                line_color: green
                points_per_hour: 6
                show:
                  labels: true
                  state: false
                name: °C
                type: custom:mini-graph-card
    type: custom:masonry-layout
    icon: mdi:thermometer
  - icon: mdi:weather-partly-cloudy
    path: ''
    cards: []
    type: sections
    sections:
      - type: grid
        cards:
          - type: custom:hourly-weather
            entity: weather.mantes_la_jolie
            num_segments: 18
            name: Next 18 hours
          - type: custom:clock-weather-card
            entity: weather.mantes_la_ville
          - type: custom:meteoalarm-card
            integration: meteoalarm
            entities: binary_sensor.meteoalarm
            override_headline: false
          - type: custom:temperature-heatmap-card
            entity: sensor.indoor_exterieur_temperature
            month_label: true
            day_label: true
            day_trend: true
            decimal_point: false
            day_forecast: true
            forecast_entity: weather.mantes_la_ville
            footer: false
      - type: grid
        cards:
          - type: iframe
            url: >-
              https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=default&zoom=8&overlay=wind&product=ecmwf&level=surface&lat=49.214&lon=1.906
            aspect_ratio: 100%
            layout_options:
              grid_columns: full
              grid_rows: 7
          - type: custom:mini-graph-card
            name: Débit de la Seine (Poissy)
            height: 120
            hours_to_show: 48
            points_per_hour: 4
            hour24: true
            line_width: 2
            line_color: rgb(68, 115, 158)
            decimals: 1
            entities:
              - entity: sensor.debit_seine_limay
                name: Débit
                show_line: true
                show_points: true
                show_legend: true
                y_axis: secondary
              - entity: sensor.hauteur_seine_limay
                name: Hauteur
                show_legend: true
                show_state: true
            show:
              fill: true
              graph: line
              icon: true
              name: true
              state: true
              labels: true
              extrema: true
              average: true
              icon_adaptive_color: false
              labels_secondary: true
            align_icon: right
            align_state: left
      - type: grid
        cards:
          - type: glance
            entities:
              - entity: sensor.lune
              - entity: sun.sun
              - entity: sensor.season
          - type: custom:list2bars-card
            entity: sensor.alertepollens
            title: Alerte Pollens
            attribute: risks
            oject_key: pollenNam
            oject_value: level
            object_key: pollenName
            object_value: level
            severity:
              - from: '0'
                to: '0'
                hide: true
              - from: '1'
                to: '1'
                color: '#DBDF00'
              - from: '2'
                to: '2'
                color: orange
              - from: '3'
                to: '3'
                color: red
            background: true
            color_background: true
            limit_value: false
            positions:
              name: 'on'
              value: 'on'
              icon: 'on'
            icon: mdi:flower-pollen
            complementary: false
            max: '3'
          - type: custom:rain-gauge-card
            entity: sensor.indoor_pluie_precipitation_aujourd_hui
            hourly_rate_entity: sensor.indoor_pluie_precipitation_last_hour
            max_level: '80'
            name: Pluie
          - type: custom:apexcharts-card
            stacked: true
            graph_span: 7d
            span:
              end: day
            header:
              show: true
              title: Suivi des précipitations
            apex_config:
              legend:
                show: false
              chart:
                height: 200px
            series:
              - entity: sensor.indoor_pluie_precipitation_aujourd_hui
                type: column
                color: blue
                group_by:
                  func: last
                  duration: 1d
                show:
                  datalabels: total
    max_columns: 3
  - type: sections
    path: ''
    max_columns: 4
    icon: mdi:cctv
    sections:
      - type: grid
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:webrtc-camera
                url: rtsp://axelle:afaure78@192.168.1.42:554/stream1
            grid_options:
              columns: 24
              rows: 8
        column_span: 2
      - type: grid
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:webrtc-camera
                url: rtsp://axelle:afaure78@192.168.1.41:554/stream1
            grid_options:
              columns: 24
              rows: 8
        column_span: 2
    cards: []
    badges:
      - type: entity
        show_name: true
        show_state: true
        show_icon: true
        entity: select.jardin_motion_detection
        name: Jardin
      - type: entity
        show_name: true
        show_state: true
        show_icon: true
        entity: select.terrasse_motion_detection
        name: Terrasse
  - type: sections
    max_columns: 4
    icon: mdi:webcam
    path: ''
    sections:
      - type: grid
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:webrtc-camera
                url: rtsp://axelle:afaure78@192.168.1.7:554/stream1
            grid_options:
              columns: 24
              rows: 8
        column_span: 2
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - features:
              - type: toggle
            type: tile
            features_position: inline
            vertical: false
            entity: input_boolean.activer_camera_interieur
            hide_state: true
            icon: mdi:webcam
          - type: horizontal-stack
            cards:
              - type: custom:bubble-card
                card_type: empty-column
              - show_name: false
                show_icon: true
                type: button
                tap_action:
                  action: toggle
                entity: button.interieur_move_up
              - type: custom:bubble-card
                card_type: empty-column
          - type: horizontal-stack
            cards:
              - show_name: false
                show_icon: true
                type: button
                tap_action:
                  action: toggle
                entity: button.interieur_move_left
              - type: custom:bubble-card
                card_type: empty-column
              - show_name: false
                show_icon: true
                type: button
                tap_action:
                  action: toggle
                entity: button.interieur_move_right
          - type: horizontal-stack
            cards:
              - type: custom:bubble-card
                card_type: empty-column
              - show_name: false
                show_icon: true
                type: button
                tap_action:
                  action: toggle
                entity: button.interieur_move_down
              - type: custom:bubble-card
                card_type: empty-column
        column_span: 1
    header: {}
    badges:
      - type: entity
        show_name: true
        show_state: true
        show_icon: true
        entity: switch.interieur_auto_track
        name: Auto Track
        show_entity_picture: false
      - type: entity
        show_name: true
        show_state: true
        show_icon: true
        entity: select.interieur_motion_detection
        name: Détection
  - title: Lucie
    path: lucie
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Emploi du temps
            heading_style: title
            icon: mdi:clock-outline
          - type: custom:pronote-timetable-card
            entity: sensor.pronote_jeanne_lucie_period_s_timetable
            display_header: false
            display_lunch_break: true
            display_classroom: true
            display_teacher: true
            display_day_hours: true
            dim_ended_lessons: true
            max_days: null
            current_week_only: false
            enable_slider: true
      - type: grid
        cards:
          - type: heading
            heading: Devoirs
            heading_style: title
            icon: mdi:notebook
          - type: custom:pronote-homework-card
            entity: sensor.pronote_jeanne_lucie_homework
            display_header: false
            display_done_homework: true
            reduce_done_homework: true
            current_week_only: false
          - type: heading
            icon: mdi:account-arrow-right
            heading: Absences
            heading_style: title
          - type: custom:pronote-absences-card
            entity: sensor.pronote_jeanne_lucie_absences
            max_absences: null
            child_name: null
      - type: grid
        cards:
          - type: heading
            heading: Dernières notes
            heading_style: title
            icon: mdi:check-decagram
          - type: custom:pronote-grades-card
            grade_format: full
            display_header: false
            display_date: true
            display_comment: true
            display_class_average: true
            compare_with_class_average: true
            compare_with_ratio: null
            display_coefficient: true
            display_class_min: true
            display_class_max: true
            display_new_grade_notice: true
            max_grades: null
            entity: sensor.pronote_jeanne_lucie_grades
      - type: grid
        cards:
          - type: heading
            heading: Moyenne
            heading_style: title
            badges: []
          - type: custom:pronote-averages-card
            entity: sensor.pronote_jeanne_lucie_averages
            average_format: full
            display_header: false
            compare_with_class_average: true
            compare_with_ratio: null
            display_class_average: true
            display_class_min: true
            display_class_max: true
  - title: Chloé
    path: chloe
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Emploi du temps
            heading_style: title
            icon: mdi:clock-outline
          - type: custom:pronote-timetable-card
            entity: sensor.pronote_jeanne_chloe_period_s_timetable
            display_header: false
            display_lunch_break: true
            display_classroom: true
            display_teacher: true
            display_day_hours: true
            dim_ended_lessons: true
            max_days: null
            current_week_only: false
            enable_slider: true
      - type: grid
        cards:
          - type: heading
            heading: Devoirs
            heading_style: title
            icon: mdi:notebook
          - type: custom:pronote-homework-card
            entity: sensor.pronote_jeanne_chloe_homework
            display_header: false
            display_done_homework: true
            reduce_done_homework: true
            current_week_only: false
          - type: heading
            icon: mdi:account-arrow-right
            heading: Absences
            heading_style: title
          - type: custom:pronote-absences-card
            entity: sensor.pronote_jeanne_chloe_absences
            max_absences: '5'
            child_name: null
      - type: grid
        cards:
          - type: heading
            heading: Dernières notes
            heading_style: title
            icon: mdi:check-decagram
          - type: custom:pronote-grades-card
            entity: sensor.pronote_jeanne_chloe_grades
            grade_format: full
            display_header: false
            display_date: true
            display_comment: true
            display_class_average: true
            compare_with_class_average: true
            compare_with_ratio: null
            display_coefficient: true
            display_class_min: true
            display_class_max: true
            display_new_grade_notice: true
            max_grades: null
            default_period: current
      - type: grid
        cards:
          - type: heading
            heading: Moyenne
            heading_style: title
            badges: []
          - type: custom:pronote-averages-card
            entity: sensor.pronote_jeanne_chloe_averages
            average_format: full
            display_header: false
            compare_with_class_average: true
            compare_with_ratio: null
            display_class_average: true
            display_class_min: true
            display_class_max: true
            default_period: current
    cards: []
  - icon: mdi:account
    path: ''
    type: sections
    sections:
      - type: grid
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: custom:mushroom-person-card
                    entity: person.axelle
                    use_entity_picture: true
                    hide_name: false
                    layout: vertical
                    card_mod:
                      style: |
                        ha-card {
                            border: none;
                            padding: 0;
                             }
                        :host {
                             --mush-icon-size: 75px;  
                             --chip-box-shadow: none;
                              --chip-background: none;
                             } 
                        hui-vertical-stack-card $: |
                          div#root > * {
                          margin: 0px !important;
                        }
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        entity: calendar.axelle
                        icon: mdi:calendar-arrow-right
                        content: >
                          {{ (states('sensor.maison_distance_axelle') |float /
                          1000) | round(2) }} km
                    alignment: center
                    card_mod:
                      style: |
                        ha-card {
                          padding: 0;
                          --chip-border-width: 0px;
                          background:none;
                          --chip-box-shadow: none;
                          --chip-background: none;
                          padding-top: 0px;
                          margin-top: -15px;
                          padding-bottom: 0px;
                          padding-left: 0px;
                          padding-right: 0px;

                        }
                        hui-vertical-stack-card $: |
                              div#root > * {
                              margin: 0px !important;
                            }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: custom:mushroom-person-card
                    entity: person.richard
                    use_entity_picture: true
                    hide_name: false
                    layout: vertical
                    card_mod:
                      style: |
                        ha-card {
                            padding: 0;
                            border: none;
                             }
                        :host {
                             --mush-icon-size: 75px;  
                             --chip-box-shadow: none;
                              --chip-background: none;
                             } 
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        entity: calendar.richard
                        icon: mdi:calendar-arrow-right
                        content: >

                          {{ (states('sensor.maison_distance_richard') |float /
                          1000) | round(2) }} km
                    alignment: center
                    card_mod:
                      style: |
                        ha-card {
                          --chip-border-width: 0px;
                          --chip-box-shadow: none;
                          --chip-background: none;
                          padding-top: 0px;
                          margin-top: -15px;
                          padding-bottom: 0px;
                          padding-left: 0px;
                          padding-right: 0px;

                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: custom:mushroom-person-card
                    entity: person.chloe
                    use_entity_picture: true
                    hide_name: false
                    layout: vertical
                    card_mod:
                      style: |
                        ha-card {
                            border: none;
                             }
                        :host {
                             --mush-icon-size: 75px;  
                             --chip-box-shadow: none;
                              --chip-background: none;
                             } 
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        entity: sensor.fin_des_cours_de_chloe_demain
                        icon: mdi:calendar-arrow-right
                        content: >
                          {{ (states('sensor.maison_distance_chloe') |float /
                          1000) | round(2) }} km
                        tap_action:
                          action: navigate
                          navigation_path: /lovelace/chloe
                    alignment: center
                    card_mod:
                      style: |
                        ha-card {
                          --chip-border-width: 0px;
                          --chip-box-shadow: none;
                              --chip-background: none;
                            padding-top: 0px;
                          margin-top: -15px;
                          padding-bottom: 0px;
                          padding-left: 0px;
                          padding-right: 0px;

                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: custom:mushroom-person-card
                    entity: person.lucie
                    use_entity_picture: true
                    hide_name: false
                    layout: vertical
                    card_mod:
                      style: |
                        ha-card {
                            border: none;
                             }
                        :host {
                             --mush-icon-size: 75px;  
                             --chip-box-shadow: none;
                              --chip-background: none;
                             } 
                           
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        entity: sensor.fin_des_cours_de_lucie_demain
                        icon: mdi:calendar-arrow-right
                        content: >
                          {{ (states('sensor.maison_distance_lucie') |float /
                          1000) | round(2) }} km
                        tap_action:
                          action: navigate
                          navigation_path: /lovelace/lucie
                    alignment: center
                    card_mod:
                      style: |
                        ha-card {
                          --chip-border-width: 0px;
                          --chip-box-shadow: none;
                              --chip-background: none;
                          padding-top: 0px;
                          margin-top: -15px;
                          padding-bottom: 0px;
                          padding-left: 0px;
                          padding-right: 0px;

                        }
      - type: grid
        cards:
          - type: map
            entities:
              - entity: person.chloe
              - entity: person.lucie
              - entity: person.axelle
              - entity: person.richard
            hours_to_show: 0
            theme_mode: auto
            layout_options:
              grid_columns: full
              grid_rows: 8
        column_span: 4
  - icon: mdi:flag-checkered
    path: ''
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading_style: title
            heading: Prochain Grand Prix
            icon: mdi:flag-checkered
          - type: custom:formulaone-card
            card_type: countdown
            f1_font: true
            show_raceinfo: false
            show_weather: false
            weather_options: {}
          - type: custom:formulaone-card
            card_type: schedule
            title: Schedule
            date_locale: fr
      - type: grid
        cards:
          - type: custom:formulaone-card
            card_type: next_race
            f1_font: true
            show_carnumber: false
            show_raceinfo: true
            show_lastyears_result: true
          - type: heading
            heading: Classement constructeur
            heading_style: title
            icon: mdi:trophy-outline
          - type: custom:formulaone-card
            card_type: constructor_standings
            standings:
              show_team: true
              show_flag: true
              show_teamlogo: true
            f1_font: true
      - type: grid
        cards:
          - type: heading
            heading: Classement pilotes
            heading_style: title
            icon: mdi:trophy
          - type: custom:formulaone-card
            card_type: driver_standings
            f1_font: true
            show_lastyears_result: false
            standings:
              show_flag: true
              show_team: true
              show_teamlogo: true
      - type: grid
        cards:
          - type: custom:formulaone-card
            card_type: results
            title: Results
  - title: Chauffage
    path: chauffage
    cards:
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.garage_mss310_power_w_main_channel
          - entity: sensor.garage_mss310_energy_kwh_main_channel
            show_state: true
            show_graph: false
        icon: mdi:fridge
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: Frigo/Congel
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
        line_color: '#fefefe'
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.garage_2_mss310_power_w_main_channel
          - entity: sensor.garage_2_mss310_energy_kwh_main_channel
            show_state: true
            show_graph: false
        icon: mdi:nas
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: NAS/BOX
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
        line_color: '#fefefe'
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.tablette_mss310_power_w_main_channel
          - entity: sensor.tablette_mss310_energy_kwh_main_channel
            show_state: true
            show_graph: false
        icon: mdi:tablet
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: Tablette
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
        line_color: '#fefefe'
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.tv_mss310_power_w_main_channel
          - entity: sensor.tv_mss310_energy_kwh_main_channel
            show_state: true
            show_graph: false
        icon: mdi:television
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: TV
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
        line_color: '#fefefe'
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.chauffage_chloe_power
          - entity: sensor.chauffage_chloe_energy
            show_state: true
            show_graph: false
        icon: mdi:radiator
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: Chauffage Chloé
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
        line_color: '#fefefe'
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.chauffage_lucie_power
          - entity: sensor.chauffage_lucie_energy
            show_state: true
            show_graph: false
        icon: mdi:radiator
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: Chauffage Lucie
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
        line_color: '#fefefe'
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.prise_bureau_power
          - entity: sensor.prise_bureau
            show_state: true
            show_graph: false
        icon: mdi:nas
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: Bureau Richard
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
        line_color: '#fefefe'
    icon: mdi:home-lightning-bolt
  - icon: mdi:solar-power-variant
    path: ''
    cards: []
    type: sections
    sections:
      - type: grid
        cards:
          - type: custom:apexcharts-card
            stacked: true
            graph_span: 7d
            span:
              end: day
            header:
              show: true
              title: Suivi Couts électricité (abonnement non inclus)
            apex_config:
              legend:
                show: false
              chart:
                height: 280px
            series:
              - entity: sensor.abonnement_edf_journalier
                type: column
                color: rgb(7,142,2)
                group_by:
                  func: last
                  duration: 1d
              - entity: sensor.cout_tempo_jour_blanc_hc
                type: column
                color: rgb(170,170,170)
                group_by:
                  func: last
                  duration: 1d
              - entity: sensor.cout_tempo_jour_blanc_hp
                type: column
                color: rgb(128,128,128)
                group_by:
                  func: last
                  duration: 1d
                show:
                  datalabels: total
              - entity: sensor.cout_tempo_jour_rouge_hp
                type: column
                color: rgb(255,0,0)
                group_by:
                  func: last
                  duration: 1d
                show:
                  datalabels: total
              - entity: sensor.cout_tempo_jour_rouge_hc
                type: column
                color: rgb(255,141,126)
                group_by:
                  func: last
                  duration: 1d
              - entity: sensor.cout_tempo_jour_bleu_hp
                type: column
                color: rgb(63,72,204)
                group_by:
                  func: last
                  duration: 1d
                show:
                  datalabels: total
              - entity: sensor.cout_tempo_jour_bleu_hc
                type: column
                color: rgb(113,155,255)
                group_by:
                  func: last
                  duration: 1d
          - type: custom:power-distribution-card
            entities:
              - decimals: '1'
                display_abs: true
                name: solar
                unit_of_display: kWh
                icon: mdi:solar-power
                producer: true
                entity: sensor.envoy_122250004672_today_s_energy_production
                preset: solar
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
                invert_value: false
                hide_arrows: true
              - decimals: '1'
                display_abs: true
                name: Export
                unit_of_display: kWh
                icon: mdi:lightning-bolt-outline
                producer: true
                entity: sensor.daily_energy_export
                preset: producer
                icon_color:
                  bigger: green
                  equal: gray
                  smaller: red
                calc_excluded: true
                invert_value: false
                hide_arrows: true
              - decimals: '1'
                display_abs: true
                name: conso
                unit_of_display: kWh
                consumer: true
                icon: mdi:home
                entity: sensor.envoy_122250004672_today_s_energy_consumption
                preset: consumer
                icon_color:
                  bigger: red
                  equal: green
                  smaller: red
                invert_value: true
                hide_arrows: true
              - decimals: '1'
                display_abs: true
                name: Import
                unit_of_display: kWh
                icon: mdi:transmission-tower
                entity: sensor.daily_energy_import
                preset: grid
                icon_color:
                  bigger: red
                  equal: gray
                  smaller: green
                invert_value: true
                hide_arrows: true
            center:
              type: bars
              content:
                - preset: ratio
                  name: use
                  bar_color: green
                  bar_bg_color: ''
                  entity: ''
                  invert_value: false
                - preset: autarky
                  name: indep
                  bar_color: yellow
            animation: flash
          - layout: vertical
            height: 150
            unit_prefix: k
            round: 1
            convert_units_to: ''
            co2_intensity_entity: sensor.co2_signal_co2_intensity
            gas_co2_intensity: 2351.6459999999997
            min_box_size: 3
            min_box_distance: 5
            show_states: true
            show_units: true
            energy_date_selection: false
            sections: []
            type: custom:sankey-chart
            autoconfig: true
            time_period_from: now/d
            min_state: 0
            show_names: true
            show_icons: false
            wide: true
            layout_options:
              grid_columns: full
              grid_rows: 8
      - type: grid
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:pie-chart-card
                title: Répartition production Electricité France
                total_amount: 100
                entities:
                  - entity: sensor.eco2mix_pourcentage_nucleaire
                    name: Nucléaire
                  - entity: sensor.eco2mix_pourcentage_charbon
                    name: Charbon
                  - entity: sensor.eco2mix_pourcentage_fioul
                    name: Fioul
                  - entity: sensor.eco2mix_pourcentage_gaz
                    name: Gaz
                  - entity: sensor.eco2mix_pourcentage_renouvelable
                    name: Renouvelable
              - type: custom:pie-chart-card
                title: Répartition production Renouvelable
                entities:
                  - entity: sensor.eco2mix_pourcentage_hydraulique
                    name: Hydrolique
                  - entity: sensor.eco2mix_pourcentage_bioenergies
                    name: Bio-Energies
                  - entity: sensor.eco2mix_pourcentage_solaire
                    name: Solaire
                  - entity: sensor.eco2mix_pourcentage_eolien
                    name: Eolien
            grid_options:
              columns: 24
              rows: auto
          - type: horizontal-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  show: true
                  title: Electricité en France
                  show_states: true
                  colorize_states: true
                apex_config:
                  legend:
                    show: false
                  chart:
                    height: 350px
                series:
                  - entity: sensor.eco2mix_consommation
                    name: Consommation
                  - entity: sensor.eco2mix_exportation
                    name: Exportation
                  - entity: sensor.eco2mix_importation
                    name: Importation
            grid_options:
              columns: 24
              rows: 7
        column_span: 2
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: entities
            entities:
              - entity: sensor.envoy_122250004672_inverter_122234041671
                name: Panneau 1
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234049187
                icon: mdi:solar-power-variant-outline
                name: Panneau 2
              - entity: sensor.envoy_122250004672_inverter_122234052078
                icon: mdi:solar-power-variant-outline
                name: Panneau 3
              - entity: sensor.envoy_122250004672_inverter_122234052220
                name: Panneau 4
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234052276
                name: Panneau 5
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234052322
                name: Panneau 6
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234052738
                name: Panneau 7
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234053029
                name: Panneau 8
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234053616
                name: Panneau 9
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234054747
                name: Panneau 10
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234055200
                name: Panneau 11
                icon: mdi:solar-power-variant-outline
              - entity: sensor.envoy_122250004672_inverter_122234055260
                name: Panneau 12
                icon: mdi:solar-power-variant-outline
  - type: sections
    max_columns: 3
    icon: mdi:car
    path: trajet
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Temps de trajets
            heading_style: title
          - type: custom:travel-time-card
            entities:
              - sensor.mantes_poissy
              - sensor.poissy_mantes
            show_header: false
            grid_options:
              columns: 24
              rows: 2
          - type: heading
            heading: Waze
            heading_style: title
          - type: iframe
            url: https://embed.waze.com/fr/iframe?zoom=12.5&lat=48.966671&lon=1.8
            aspect_ratio: 50%
            grid_options:
              columns: full
              rows: 8
          - type: custom:flex-table-card
            sort_by: state+
            clickable: true
            title: Prix du carburant E10
            entities:
              include:
                - sensor.station_*_e10
              exclude: null
            max_rows: 20
            columns:
              - data: entity_picture
                name: ' '
                align: center
                icon: mdi:gas-station
                modify: '''<img src="'' + x + ''"style="height: 35px">'''
              - attr: name
                icon: mdi:map-search-outline
                name: ' '
                align: left
              - data: state
                icon: mdi:currency-eur
                suffix: €
                name: ' '
                align: center
              - attr: distance
                icon: mdi:map-marker-distance
                align: center
                modify: Math.round(x)
                suffix: ' km'
                name: ' '
              - icon: mdi:calendar-clock
                name: ' '
                data: days_since_last_update
                align: center
                modify: |
                  if (x>=1) {'J+'+x} else {'Auj.'}
            css:
              tbody tr:nth-child(odd): 'background-color: rgba(255, 255, 255, 0.2)'
              tbody tr:nth-child(even): 'background-color: rgba(255, 255, 255, 0.1)'
              tbody tr:nth-child(1): 'color: #00C62D; font-weight: bold'
              tbody tr:nth-child(2): 'font-weight: normal'
            card_mod: null
            style: |
              :host {
                font-size: 14px;
                border-radius: 10px;
              }
          - type: custom:flex-table-card
            sort_by: state+
            clickable: true
            title: Prix du carburant Gazole
            entities:
              include:
                - sensor.station_*_gazole
              exclude: null
            max_rows: 20
            columns:
              - data: entity_picture
                name: ' '
                align: center
                icon: mdi:gas-station
                modify: '''<img src="'' + x + ''"style="height: 35px">'''
              - attr: name
                icon: mdi:map-search-outline
                name: ' '
                align: left
              - data: state
                icon: mdi:currency-eur
                suffix: €
                name: ' '
                align: center
              - attr: distance
                icon: mdi:map-marker-distance
                align: center
                modify: Math.round(x)
                suffix: ' km'
                name: ' '
              - icon: mdi:calendar-clock
                name: ' '
                data: days_since_last_update
                align: center
                modify: |
                  if (x>=1) {'J+'+x} else {'Auj.'}
            css:
              tbody tr:nth-child(odd): 'background-color: rgba(255, 255, 255, 0.2)'
              tbody tr:nth-child(even): 'background-color: rgba(255, 255, 255, 0.1)'
              tbody tr:nth-child(1): 'color: #00C62D; font-weight: bold'
              tbody tr:nth-child(2): 'font-weight: normal'
            card_mod: null
            style: |
              :host {
                font-size: 14px;
                border-radius: 10px;
              }
        column_span: 2
      - type: grid
        cards:
          - type: heading
            heading: Transport en commun
            heading_style: title
          - type: custom:idf-mobilite-card
            lineType: BUS
            entity: sensor.prim_lignem
            show_screen: true
            show_bus_stop_label: true
            second_entity: sensor.prim_lignee
            show_train_ref: false
            exclude_second_lines: bus-21
          - type: custom:idf-mobilite-card
            lineType: RER
            entity: sensor.prim_mantes
            show_screen: true
            messages: sensor.prim_mantesmessage
            exclude_lines: train-N
            nb_departure_first_line: '3'
            nb_departure_second_line: '2'
            show_train_ref: false
            second_entity: sensor.prim_mantesstation
            exclude_second_lines_ref: 41150;41287
            exclude_lines_ref: 41287;411364;87411017:LO;
      - type: grid
        cards: []
        column_span: 2
      - type: grid
        cards: []
    cards: []
  - type: sections
    max_columns: 1
    title: test
    path: test
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Alexa
            heading_style: title
            icon: mdi:speaker
          - type: custom:card-alexa-alarms-timers
            entities_alarm:
              - sensor.cuisine_next_alarm
              - sensor.salon_next_alarm
              - sensor.lucie_next_alarm
              - sensor.chloe_next_alarm
              - sensor.axelle_next_alarm
            entities_timer:
              - sensor.cuisine_next_timer
              - sensor.salon_next_timer
              - sensor.lucie_next_timer
              - sensor.chloe_next_timer
              - sensor.axelle_next_timer
            entities_reminder:
              - sensor.cuisine_next_reminder
              - sensor.salon_next_reminder
              - sensor.lucie_next_reminder
              - sensor.chloe_next_reminder
              - sensor.axelle_next_reminder
            remaining_time_bold: true
            show_cancel_button: false
            cancel_entity: media_player.salon
            hide_card_on_empty: false
            card_title: Alexa Rappels, alarmes et minuteurs
            show_device_name: true
            show_empty_hours: true
            show_alarm_name_seconds: true
            display_style: table
        column_span: 3
    cards: []
    icon: mdi:timer-alert
  - type: sections
    max_columns: 1
    path: essai
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: custom:vacuum-card
            entity: vacuum.r2d2_2
            actions:
              start:
                service: xiaomi_miio.vacuum_clean_segment
                service_data:
                  entity_id: vacuum.vacuum_cleaner
                  segments:
                    - 16
                    - 20
    icon: mdi:robot-vacuum
  - type: sections
    icon: mdi:access-point-network
    path: ''
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: horizontal-stack
            cards:
              - type: custom:flex-table-card
                entities:
                  include: sensor.network_scanner
                sort_by: x.ip+
                columns:
                  - name: IP Address
                    data: devices
                    modify: x.ip
                  - name: MAC Address
                    data: devices
                    modify: x.mac
                  - name: Custom Name
                    data: devices
                    modify: x.name
                  - name: Custom Description
                    data: devices
                    modify: x.type
                  - name: Hostname
                    data: devices
                    modify: x.hostname
                  - name: Vendor
                    data: devices
                    modify: x.vendor
            grid_options:
              columns: 33
              rows: auto
        column_span: 3
    cards: []
    max_columns: 3
  - type: sections
    max_columns: 4
    icon: mdi:home
    path: ''
    sections:
      - type: grid
        cards:
          - type: picture-elements
            elements:
              - type: state-badge
                entity: sensor.temp_salon_temperature
                name: false
                title: null
                style:
                  top: 60%
                  left: 25%
                  font-size: 10px
                  '--ha-label-badge-size': 40px
                  color: transparent
              - type: state-badge
                entity: sensor.ble_temperature_temperature_chambre
                name: false
                title: null
                style:
                  top: 25%
                  left: 20%
                  font-size: 10px
                  '--ha-label-badge-size': 40px
                  color: transparent
              - type: state-badge
                entity: sensor.ble_temperature_temperature_chambre_chloe
                name: false
                title: null
                style:
                  top: 26%
                  left: 50%
                  font-size: 10px
                  '--ha-label-badge-size': 40px
                  color: transparent
              - type: state-badge
                entity: sensor.ble_temperature_temperature_chambre_de_lucie
                name: false
                title: null
                style:
                  top: 60%
                  left: 55%
                  font-size: 8px
                  '--ha-label-badge-size': 30px
                  color: transparent
              - type: state-badge
                entity: sensor.ble_temperature_temperature_sdb
                name: false
                title: null
                style:
                  top: 26%
                  left: 80%
                  font-size: 10px
                  '--ha-label-badge-size': 40px
                  color: transparent
              - type: state-badge
                entity: sensor.temp1_temperature
                name: false
                title: null
                style:
                  top: 80%
                  left: 85%
                  font-size: 12px
                  '--ha-label-badge-size': 40px
                  color: transparent
              - type: state-icon
                entity: switch.garage
                name: false
                title: null
                style:
                  top: 60%
                  left: 95%
              - type: state-icon
                entity: light.halogene
                name: false
                title: null
                style:
                  top: 75%
                  left: 6%
              - type: state-icon
                entity: light.salon_3
                name: false
                title: null
                style:
                  top: 75%
                  left: 43%
              - type: state-icon
                entity: light.chambre_parents
                name: false
                title: null
                style:
                  top: 28%
                  left: 20%
              - type: state-icon
                entity: light.go2
                name: false
                title: null
                style:
                  top: 25%
                  left: 6%
              - type: state-icon
                entity: light.led_chloe
                name: false
                icon: mdi:led-strip-variant
                title: null
                style:
                  top: 28%
                  left: 50%
              - type: state-icon
                entity: light.led
                name: false
                icon: mdi:led-strip-variant
                title: null
                style:
                  top: 28%
                  left: 85%
              - type: state-icon
                entity: light.led_lucie
                name: false
                icon: mdi:led-strip-variant
                title: null
                style:
                  top: 23%
                  left: 94%
              - type: state-icon
                entity: light.led_lucie
                name: false
                title: null
                style:
                  top: 18%
                  left: 72%
              - type: state-icon
                entity: light.bureau_chloe
                name: false
                title: null
                style:
                  top: 6%
                  left: 40%
              - type: state-icon
                entity: light.twinkly_621ad1
                icon: mdi:string-lights
                name: false
                title: null
                style:
                  top: 75%
                  left: 25%
              - type: state-icon
                entity: light.couloir
                name: false
                title: null
                style:
                  top: 37%
                  left: 50%
            image: >-
              https://raw.githubusercontent.com/Axelle78/test/refs/heads/master/MAISON.png
            grid_options:
              rows: 14
              columns: 21
        column_span: 2
  - type: sections
    max_columns: 4
    path: conso
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Plantes
            heading_style: title
            icon: mdi:flower
          - type: custom:flower-card
            entity: plant.tomate
            battery_sensor: sensor.myflower_battery
            show_bars:
              - moisture
              - conductivity
              - temperature
              - illuminance
              - humidity
              - dli
          - type: custom:flower-card
            entity: plant.ficus
            battery_sensor: sensor.myflower_battery
            show_bars:
              - moisture
              - conductivity
              - temperature
              - illuminance
              - humidity
              - dli
            grid_options:
              columns: 12
              rows: 5
      - type: grid
        cards:
          - type: custom:flower-card
            entity: plant.arbre_de_judee
            battery_sensor: sensor.jardin_battery
            show_bars:
              - conductivity
              - temperature
              - humidity
            grid_options:
              columns: 12
              rows: 5
            display_type: full
    icon: mdi:flower
    cards: []
  - type: sections
    max_columns: 4
    icon: mdi:battery
    path: ''
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: custom:battery-state-card
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: custom:list2bars-card
            entity: sensor.batterie_surface
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: custom:auto-entities
            card:
              type: custom:bar-card
              title_position: inside
              height: 38
              card_mod: null
              positions:
                icon: inside
                indicator: inside
                name: inside
                value: inside
              show_icon: true
              icon: mdi:battery
              align: split
              columns: '1'
              max: 100
              unit_of_measurement: '%'
              severity:
                - color: '#d11e1e'
                  from: 0
                  to: 5
                - color: '#cf2d11'
                  from: 6
                  to: 10
                - color: '#cc3900'
                  from: 11
                  to: 15
                - color: '#c84400'
                  from: 16
                  to: 20
                - color: '#c44d00'
                  from: 21
                  to: 25
                - color: '#bf5600'
                  from: 26
                  to: 30
                - color: '#b95f00'
                  from: 31
                  to: 35
                - color: '#b36600'
                  from: 36
                  to: 40
                - color: '#ac6e00'
                  from: 41
                  to: 45
                - color: '#a57500'
                  from: 46
                  to: 50
                - color: '#9d7b00'
                  from: 51
                  to: 55
                - color: '#948100'
                  from: 56
                  to: 60
                - color: '#8b8700'
                  from: 61
                  to: 65
                - color: '#818d00'
                  from: 66
                  to: 70
                - color: '#769200'
                  from: 71
                  to: 75
                - color: '#6a9700'
                  from: 76
                  to: 80
                - color: '#5d9c00'
                  from: 81
                  to: 85
                - color: '#4da100'
                  from: 86
                  to: 90
                - color: '#39a500'
                  from: 91
                  to: 95
                - color: '#15a911'
                  from: 96
                  to: 100
              style: |
                bar-card-currentbar, bar-card-current, bar-card-backgroundbar {
                     height: 5px !important;
                    margin-top: 30px;
                }
                ha-card {
                    background: none;
                    box-shadow: none;
                }
                ha-icon{
                  color: white !important;
                }
                bar-card-iconbar {
                    margin-bottom: 10px;
                }
              animation:
                state: 'on'
                speed: '2'
            filter:
              exclude:
                - entity_id: ^sensor.robonect*$
              include:
                - entity_id: ^sensor.radiateur_*_battery_level$
                - entity_id: ^sensor.*_battery$
                - entity_id: ^sensor.tpms*_batt$
                - entity_id: ^sensor.*_battery_charge$
            sort:
              method: state
              numeric: true
            show_empty: false
  - type: sections
    max_columns: 4
    icon: mdi:power-plug-battery-outline
    path: ''
    sections:
      - type: grid
        cards:
          - type: entities
            entities:
              - type: custom:hui-element
                card_type: markdown
                content: >
                  Eaton Eco 650 ---
                  {{states('sensor.eaton_ellipse_eco_650_etat')}}
                card_mod:
                  style: |
                    ha-card.type-markdown {
                      font-size: 17px !important;
                      display: flex !important;
                      justify-content: center !important;
                    }
                    ha-card {
                      border-width: 0px !important;
                      background: none;
                    }
                    ha-markdown {
                      padding: 16px 16px 0px !important;
                    }  
              - type: custom:hui-element
                card_type: vertical-stack
                cards:
                  - type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      grid-template-columns: 50% 50%
                      place-items: center
                    cards:
                      - type: picture
                        image: >-
                          https://raw.githubusercontent.com/Axelle78/test/refs/heads/master/EATON1-removebg-preview.png
                        card_mod:
                          style: |
                            ha-card {
                              border-width: 0px !important;
                              background: none;
                            }
                      - type: custom:button-card
                        entity: sensor.eaton_ellipse_eco_650_autonomie_de_la_batterie
                        name: 'Remaining:'
                        icon: mdi:battery-high
                        layout: icon_name_state2nd
                        show_icon: true
                        show_state: true
                        card_mod:
                          style: |
                            ha-card {
                              border-width: 0px !important;
                              place-self: flex-start !important;
                              background: none;
                            }
                            div#name.ellipsis {
                              place-self: flex-start !important;
                            }
                            div#state.ellipsis {
                              place-self: flex-start !important;
                            }
              - type: custom:bar-card
                columns: 2
                entity_row: true
                positions:
                  icon: inside
                  indicator: 'off'
                  name: inside
                  value: inside
                entities:
                  - entity: sensor.eaton_ellipse_eco_650_charge_de_la_batterie
                    name: Battery
                    icon: mdi:battery-high
                    unit_of_measurement: '%'
                    severity:
                      - from: 0
                        to: 17
                        color: '#d70000'
                      - from: 18
                        to: 34
                        color: '#d45e00'
                      - from: 35
                        to: 51
                        color: '#cf9000'
                      - from: 52
                        to: 68
                        color: '#cfd300'
                      - from: 69
                        to: 84
                        color: '#84cf00'
                      - from: 85
                        to: 100
                        color: '#30d000'
                  - entity: sensor.eaton_ellipse_eco_650_charge
                    name: Load
                    icon: mdi:gauge
                    unit_of_measurement: '%'
                    severity:
                      - value: 50
                        color: '#3498db'
                      - value: 75
                        color: '#f39c12'
                      - value: 100
                        color: '#e45e65'
                card_mod:
                  style: |
                    ha-card { 
                      --paper-item-icon-color: var(--primary-text-color);
                      border-width: 0px !important;
                      background: none;
                    }
              - type: custom:hui-element
                card_type: entities
                entities:
                  - entity: sensor.eaton_ellipse_eco_650_tension_de_sortie
                    name: Input Voltage
                card_mod:
                  style: |
                    ha-card { 
                      --paper-item-icon-color: var(--primary-text-color);
                      border-width: 0px !important;
                      background: none;
                    }
            card_mod:
              style: |
                div#states.card-content {
                  padding: 0px 16px 16px 16px !important;
                  background: none;
                }
      - type: grid
        cards:
          - type: entities
            entities:
              - type: custom:hui-element
                card_type: markdown
                content: |
                  Eaton Pro 650 --- {{states('sensor.ups_etat')}}
                card_mod:
                  style: |
                    ha-card.type-markdown {
                      font-size: 17px !important;
                      display: flex !important;
                      justify-content: center !important;
                    }
                    ha-card {
                      border-width: 0px !important;
                    }
                    ha-markdown {
                      padding: 16px 16px 0px !important;
                    } 
                    ha-card {
                      border: none;
                      background: none;
                        }
              - type: custom:hui-element
                card_type: vertical-stack
                cards:
                  - type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      grid-template-columns: 50% 50%
                      place-items: center
                    cards:
                      - type: picture
                        image: >-
                          https://raw.githubusercontent.com/Axelle78/test/refs/heads/master/EATON2-removebg-preview.png
                        card_mod:
                          style: |
                            ha-card {
                              border-width: 0px !important;
                              border : none;
                              background: none;
                            }
                      - type: custom:button-card
                        entity: sensor.ups_autonomie_de_la_batterie
                        name: 'Remaining:'
                        icon: mdi:battery-high
                        layout: icon_name_state2nd
                        show_icon: true
                        show_state: true
                        card_mod:
                          style: |
                            ha-card {
                              border-width: 0px !important;
                              place-self: flex-start !important;
                              border: none;
                              background: none;
                            }
                            div#name.ellipsis {
                              place-self: flex-start !important;
                            }
                            div#state.ellipsis {
                              place-self: flex-start !important;
                            }
              - type: custom:bar-card
                columns: 2
                entity_row: true
                positions:
                  icon: inside
                  indicator: 'off'
                  name: inside
                  value: inside
                entities:
                  - entity: sensor.ups_charge_de_la_batterie
                    name: Battery
                    icon: mdi:battery-high
                    unit_of_measurement: '%'
                    severity:
                      - from: 0
                        to: 17
                        color: '#d70000'
                      - from: 18
                        to: 34
                        color: '#d45e00'
                      - from: 35
                        to: 51
                        color: '#cf9000'
                      - from: 52
                        to: 68
                        color: '#cfd300'
                      - from: 69
                        to: 84
                        color: '#84cf00'
                      - from: 85
                        to: 100
                        color: '#30d000'
                  - entity: sensor.ups_charge
                    name: Load
                    icon: mdi:gauge
                    unit_of_measurement: '%'
                    severity:
                      - value: 50
                        color: '#3498db'
                      - value: 75
                        color: '#f39c12'
                      - value: 100
                        color: '#e45e65'
                card_mod:
                  style: |
                    ha-card { 
                      --paper-item-icon-color: var(--primary-text-color);
                      border-width: 0px !important;
                      background: none;
                    }
              - type: custom:hui-element
                card_type: entities
                entities:
                  - entity: sensor.ups_tension_de_sortie
                card_mod:
                  style: |
                    ha-card { 
                      --paper-item-icon-color: var(--primary-text-color);
                      border-width: 0px !important;
                      background: none;
                    }
            card_mod:
              style: |
                div#states.card-content {
                  padding: 0px 16px 16px 16px !important;
                }
      - type: grid
        cards:
          - type: vertical-stack
            cards:
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: custom:hui-element
                    card_type: markdown
                    content: |
                      Synology
                    card_mod:
                      style: |
                        ha-card.type-markdown {
                          font-size: 17px !important;
                          display: flex !important;
                          justify-content: center !important;
                        }
                        ha-card {
                          border-width: 0px !important;
                        }
                            ha-markdown {
                          padding: 16px 16px 0px !important;
                        } 
                        ha-card {
                          border: none;
                          background: none;
                            }
                  - type: entities
                    entities:
                      - entity: sensor.nas_synology_drive_1_etat
                        type: custom:multiple-entity-row
                        state_header: HDD 2
                        name: Status
                        icon: mdi:nas
                        entities:
                          - entity: sensor.nas_synology_drive_2_etat
                            name: HDD 1
                      - entity: sensor.nas_synology_temperature
                        type: custom:multiple-entity-row
                        state_header: Serveur
                        name: Température
                        entities:
                          - entity: sensor.nas_synology_drive_1_temperature
                            name: HDD 1
                          - entity: sensor.nas_synology_drive_2_temperature
                            name: HDD 2
                      - entity: update.nas_synology_mise_a_jour_dsm
                        icon: mdi:update
                        name: Mise à jour DSM
                    card_mod:
                      style: |
                        ha-card {
                          border: none;
                          font-weight: 500;
                          margin-right: 10px;
                        }
                  - type: custom:stack-in-card
                    mode: horizontal
                    cards:
                      - type: custom:stack-in-card
                        cards:
                          - type: custom:apexcharts-card
                            chart_type: radialBar
                            series:
                              - entity: >-
                                  sensor.nas_synology_utilisation_du_processeur_totale
                                color: rgb(76, 175, 80)
                                max: 100
                                show:
                                  legend_value: false
                            apex_config:
                              plotOptions:
                                radialBar:
                                  offsetY: 0
                                  startAngle: -108
                                  endAngle: 108
                                  hollow:
                                    size: 70%
                                  dataLabels:
                                    name:
                                      show: false
                                    value:
                                      show: false
                                  track:
                                    strokeWidth: 80%
                                    margin: 0
                              legend:
                                show: false
                              chart:
                                height: 140px
                            card_mod:
                              style: |
                                ha-card {
                                  border: none;
                                  background: none;
                                }
                          - type: custom:mushroom-entity-card
                            entity: >-
                              sensor.nas_synology_utilisation_du_processeur_totale
                            primary_info: name
                            secondary_info: state
                            name: CPU
                            icon_color: green
                            layout: vertical
                            card_mod:
                              style: |
                                ha-card {
                                  top: -63px;
                                  border: none;
                                  background: none;
                                }
                        card_mod:
                          style: |
                            ha-card {
                              height: 158px;
                              border: none;
                              background: none;
                            }
                      - type: custom:stack-in-card
                        cards:
                          - type: custom:apexcharts-card
                            chart_type: radialBar
                            series:
                              - entity: >-
                                  sensor.nas_synology_utilisation_de_la_memoire_reelle
                                color: rgb(33, 150, 243)
                                max: 100
                                show:
                                  legend_value: false
                            apex_config:
                              plotOptions:
                                radialBar:
                                  offsetY: 0
                                  startAngle: -108
                                  endAngle: 108
                                  hollow:
                                    size: 70%
                                  dataLabels:
                                    name:
                                      show: false
                                    value:
                                      show: false
                                  track:
                                    strokeWidth: 80%
                                    margin: 0
                              legend:
                                show: false
                              chart:
                                height: 140px
                            card_mod:
                              style: |
                                ha-card {
                                  border: none;
                                  background: none;
                                }
                          - type: custom:mushroom-entity-card
                            entity: >-
                              sensor.nas_synology_utilisation_de_la_memoire_reelle
                            primary_info: name
                            secondary_info: state
                            name: RAM
                            icon_color: blue
                            layout: vertical
                            card_mod:
                              style: |
                                ha-card {
                                  top: -63px;
                                  border: none;
                                  background: none;
                                }
                        card_mod:
                          style: |
                            ha-card {
                              height: 158px;
                              border: none;
                              background: none;
                            }
                      - type: custom:stack-in-card
                        cards:
                          - type: custom:apexcharts-card
                            chart_type: radialBar
                            series:
                              - entity: sensor.nas_synology_volume_1_volume_utilise
                                color: rgb(255, 87, 34)
                                max: 100
                                show:
                                  legend_value: false
                            apex_config:
                              plotOptions:
                                radialBar:
                                  offsetY: 0
                                  startAngle: -108
                                  endAngle: 108
                                  hollow:
                                    size: 70%
                                  dataLabels:
                                    name:
                                      show: false
                                    value:
                                      show: false
                                  track:
                                    strokeWidth: 80%
                                    margin: 0
                              legend:
                                show: false
                              chart:
                                height: 140px
                            card_mod:
                              style: |
                                ha-card {
                                  border: none;
                                  background: none;
                                }
                          - type: custom:mushroom-entity-card
                            entity: sensor.nas_synology_volume_1_volume_utilise
                            primary_info: name
                            secondary_info: state
                            name: Disque dur
                            icon_color: deep-orange
                            layout: vertical
                            card_mod:
                              style: |
                                ha-card {
                                  top: -63px;
                                  border: none;
                                  background: none;
                                }
                        card_mod:
                          style: |
                            ha-card {
                              height: 158px;
                              border: none;
                              background: none;
                            }
                    columns: 3
                    card_mod:
                      style: |
                        ha-card {
                          border: none;
                          margin-top: -15px;
                          background: none;
                        }
                  - type: custom:vertical-stack-in-card
                    cards:
                      - type: grid
                        square: false
                        columns: 2
                        cards:
                          - type: custom:mushroom-entity-card
                            entity: sensor.nas_synology_debit_de_telechargement
                            primary_info: state
                            secondary_info: name
                            name: Téléchargement
                            icon_color: orange
                            card_mod:
                              style: |
                                ha-card {
                                  border: none;
                                  background: none;
                                }
                          - type: custom:mushroom-entity-card
                            entity: sensor.nas_synology_debit_de_transfert
                            primary_info: state
                            secondary_info: name
                            name: Transfert
                            icon_color: blue
                            card_mod:
                              style: |
                                ha-card {
                                  border: none;
                                  background: none;
                                }
                      - type: custom:mini-graph-card
                        entities:
                          - entity: sensor.nas_synology_debit_de_telechargement
                            name: Temperature
                            color: var(--orange-color)
                          - entity: sensor.nas_synology_debit_de_transfert
                            name: Humidity
                            color: var(--blue-color)
                            y_axis: secondary
                        hours_to_show: 24
                        line_width: 3
                        font_size: 50
                        animate: true
                        show:
                          name: false
                          icon: false
                          state: false
                          legend: false
                          fill: fade
                        card_mod:
                          style: |
                            ha-card {
                              border: none;
                              margin-top: -15px;
                              background: none;
                            }
                    card_mod:
                      style: |
                        ha-card {
                          border: none;
                          margin-top: -25px;
                          background: none;
                        }
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: custom:button-card
            template: hc_dishwasher_card
  - type: sections
    max_columns: 4
    icon: mdi:calendar-account
    path: ''
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Poubelles
            heading_style: title
            icon: mdi:trash-can
          - entities:
              - entity: calendar.recyclage
                color: ''
                accent_color: green
            days_to_show: 15
            weather:
              position: date
              date:
                show_conditions: true
                show_high_temp: true
                show_low_temp: true
                icon_size: 18px
                font_size: 12px
                color: var(--primary-text-color)
              event:
                show_conditions: true
                show_temp: true
                icon_size: 14px
                font_size: 12px
                color: var(--primary-text-color)
              entity: weather.mantes_la_ville
            type: custom:calendar-card-pro
      - type: grid
        cards:
          - type: heading
            heading_style: title
            heading: Anniversaire
            icon: mdi:cake-variant
          - entities:
              - entity: calendar.anniversaires
                show_time: false
                show_location: false
                split_multiday_events: false
                color: green
            days_to_show: 15
            weather:
              position: date
              date:
                show_conditions: true
                show_high_temp: true
                show_low_temp: false
                icon_size: 14px
                font_size: 12px
                color: var(--primary-text-color)
              event:
                show_conditions: true
                show_temp: true
                icon_size: 14px
                font_size: 12px
                color: var(--primary-text-color)
            type: custom:calendar-card-pro
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: vertical-stack
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: custom:apexcharts-card
                    chart_type: radialBar
                    series:
                      - entity: sensor.salon_temperature
                        max: 40
                        color: '#00FF00'
                        show:
                          legend_value: false
                      - entity: sensor.humidite_salon
                        max: 100
                        color: '#FEFEFE'
                        show:
                          legend_value: false
                    apex_config:
                      plotOptions:
                        radialBar:
                          offsetY: -5
                          hollow:
                            size: 70%
                          dataLabels:
                            name:
                              show: false
                            value:
                              show: false
                          track:
                            dropShadow:
                              enabled: true
                              top: 3
                              left: 0
                              blur: 4
                              opacity: 0.25
                            strokeWidth: 75%
                            margin: 3
                      fill:
                        type: gradient
                        gradient:
                          gradientToColors:
                            - '#E73E01'
                            - '#0F9DE8'
                          stops:
                            - 0
                            - 100
                      legend:
                        show: false
                      chart:
                        height: 220
                    card_mod:
                      style: |
                        ha-card {
                          background: none;
                          box-shadow: none;
                          border: none;
                        }
                  - type: custom:button-card
                    entity: sensor.salon_temperature
                    size: 6%
                    icon: mdi:sofa
                    show_state: false
                    show_name: false
                    label: Salon
                    show_label: true
                    styles:
                      grid:
                        - grid-template-areas: '"battery" "i" "l" "temp" "hum"'
                      label:
                        - font-size: 12px
                        - font-style: italic
                        - opacity: 75%
                      icon:
                        - opacity: 75%
                      custom_fields:
                        temp:
                          - font-size: 27px
                        hum:
                          - font-size: 14px
                          - font-style: italic
                        battery:
                          - padding-left: 180px
                    custom_fields:
                      temp: >
                        [[[ var temp = states['sensor.salon_temperature'
                        ].state; return `<ha-icon
                          icon="mdi:thermometer"
                          style="width: 20px; height: 20px; color: #7dc8ff ">
                          </ha-icon>` + temp + '°'; ]]]
                      hum: >
                        [[[ var hum = states['sensor.humidite_salon'
                        ].state;     return `<ha-icon
                          icon="mdi:water"
                          style="width: 15px; height: 15px; color: #7dc8ff ">
                          </ha-icon>` + hum + '%'; ]]]
                      battery: >
                        [[[ if (states['sensor.ble_battery_a4c1383e063d'].state
                        >= 70) return `<ha-icon 
                              icon="mdi:battery"
                              style="width: 20px; height: 20px; color: green ">
                              </ha-icon>`;
                            if (states['sensor.capteur_temperature_1_battery'].state >= 20) return `<ha-icon 
                              icon="mdi:battery-50"
                              style="width: 20px; height: 20px; color: orange ">
                              </ha-icon>`;
                            if (states['sensor.capteur_temperature_1_battery'].state >= 1) return `<ha-icon 
                              icon="mdi:battery-10"
                              style="width: 20px; height: 20px; color: red ">
                              </ha-icon>`; ]]]
                    card_mod:
                      style: |
                        ha-card {
                          margin-top: -185px;
                          background: none;
                          box-shadow: none;
                          border: none;
                        }
                card_mod:
                  style: |
                    ha-card {
                    background: none;
                    box-shadow: none;
                    border: none;
                    }
            grid_options:
              columns: 6
              rows: auto
  - type: sections
    max_columns: 4
    title: ddd
    path: ddd
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: custom:button-card
            name: 🏠 Résumé Maison
            show_icon: false
            show_name: true
            layout: vertical
            styles:
              card:
                - padding: 10px
                - font-size: 16px
                - line-height: 1.5
                - white-space: pre-line
                - text-align: left
            custom_fields:
              résumé: |
                [[[
                  const personnes = Object.values(states).filter(e => e.entity_id.startsWith('person.') && e.state === 'home').length;
                  const totalPersonnes = Object.values(states).filter(e => e.entity_id.startsWith('person.')).length;

                  const lumieres = Object.values(states).filter(e => e.entity_id.startsWith('light.') && e.state === 'on').length;

                  const puissance = states['sensor.maison_puissance'] ? states['sensor.maison_puissance'].state : "N/A";

                  const appareils = Object.values(states).filter(e =>
                    (e.entity_id.startsWith('switch.') || e.entity_id.startsWith('media_player.') || e.entity_id.startsWith('plug.')) &&
                    e.state === 'on'
                  ).length;

                  const alertes = states['sensor.alertes_maison'] ? states['sensor.alertes_maison'].state : "Aucune";

                  return `👨‍👩‍👧‍👦 Présents : ${personnes} / ${totalPersonnes}  
                💡 Lumières ON: ${lumieres}
                ⚡ Conso: ${puissance} W
                ⚙️ Appareils actifs: ${appareils}
                🚨 Alertes: ${alertes}`; ]]]
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: tile
            entity: device_tracker.vr3uphpx7r4128366_vehicule
            features_position: bottom
            vertical: true
            show_entity_picture: true
            name: '208'
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - vehicle_image_type: default
            status_image_type: none
            layout_type: single
            formatted_entities: true
            show_location: true
            show_mileage: true
            show_car_state: true
            show_info_icons: true
            help_highlight: true
            sections_order:
              - title
              - image
              - info
              - bar_0
            bars:
              - left_title: Essence
                left_entity: ''
                right_entity: sensor.vr3uphpx7r4128366_autonomie_carburant
                bar_color: 'var(--primary-color, #3498db)'
                background_color: 'var(--card-background-color, #121212)'
                border_color: 'var(--divider-color, #555555)'
                left_title_color: 'var(--secondary-text-color, #999999)'
                left_text_color: 'var(--primary-text-color, #ffffff)'
                right_title_color: 'var(--secondary-text-color, #999999)'
                right_text_color: 'var(--primary-text-color, #ffffff)'
                limit_indicator_color: 'var(--error-color, #ff0000)'
                left_title_size: 14
                left_text_size: 14
                right_title_size: 14
                right_text_size: 14
                percentage_text_size: 14
                bar_size: thick
                bar_radius: round
                bar_style: flat
                show_left: true
                show_right: true
                show_percentage: true
                show_left_title: true
                show_left_value: true
                show_right_title: true
                show_right_value: true
                percentage_type: entity
                percentage_amount_entity: ''
                percentage_total_entity: ''
                percentage_attribute: ''
                percentage_template: ''
                alignment: space-between
                width: '100'
                use_gradient: true
                gradient_display_mode: value_based
                gradient_stops:
                  - id: '1'
                    position: 0
                    color: '#ff0000'
                  - id: '2'
                    position: 100
                    color: '#00ff00'
                animation_entity: ''
                animation_state: ''
                animation_type: none
                action_animation_entity: ''
                action_animation_state: ''
                action_animation: none
                entity: sensor.vr3uphpx7r4128366_niveau_carburant
                bar_name: Carburant
                left_condition:
                  type: none
                  entity: ''
                  state: ''
                right_condition:
                  type: none
                  entity: ''
                  state: ''
                right_title: 'Autonomie '
                right_template_mode: false
            icon_rows: []
            type: custom:ultra-vehicle-card
            title: '208'
            title_alignment: center
            title_size: 24
            title_bold: true
            show_units: true
            vehicle_image_width: 100
            action_image_width: 100
            images:
              - id: ryvkb4t
                name: ''
                image_type: url
                image_width: 100
                priority: 0
                image: >-
                  https://raw.githubusercontent.com/Axelle78/test/refs/heads/master/208.png
            image_priority_mode: order
            info_rows:
              - id: ulr3oez
                width: '100'
                alignment: center
                vertical_alignment: center
                spacing: medium
                columns: 0
                allow_wrap: false
                info_entities:
                  - id: ntj7ar9
                    entity: sensor.vr3uphpx7r4128366_kilometrage
                    name: ''
                    icon: mdi:road-variant
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: false
                    dynamic_icon_template: ''
                    dynamic_color_template_mode: false
                    dynamic_color_template: ''
                  - id: ih1jern
                    entity: sensor.depassement_km
                    icon: mdi:car
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: false
                    dynamic_icon_template: ''
                    dynamic_color_template_mode: true
                    dynamic_color_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      red {%else%} green {%endif%}
                row_name: Kilométrage
              - id: jyfxgib
                width: '100'
                alignment: center
                vertical_alignment: center
                spacing: medium
                columns: 0
                allow_wrap: false
                info_entities:
                  - id: 5yfosks
                    entity: sensor.alerte_km
                    name: ''
                    icon: mdi:alert-circle-check-outline
                    show_icon: true
                    show_name: false
                    text_size: 14
                    name_size: 14
                    icon_size: 24
                    icon_color: var(--secondary-text-color)
                    text_color: var(--primary-text-color)
                    on_click_action: more-info
                    dynamic_icon_template_mode: true
                    dynamic_icon_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      mdi:alert
                                {%elif states('sensor.depassement_km') | round(0) <-100 %} mdi:alert-circle-check
                                {%else%} mdi:alert-circle
                                {%endif%}
                    dynamic_color_template_mode: true
                    dynamic_color_template: >-
                      {% if states('sensor.depassement_km') | round(0) >0  %}
                      red
                                {%elif states('sensor.depassement_km') | round(0) <-100 %} green
                                {%else%} yellow
                                {%endif%}
                    template_mode: false
                    value_template: ''
            grid_options:
              columns: 12
              rows: 1
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
    header:
      card:
        type: custom:button-card
        show_icon: false
        show_name: true
        layout: vertical
        styles:
          card:
            - padding: 10px
            - font-size: 16px
            - line-height: 1.5
            - white-space: pre-line
            - background-color: transparent
            - text-align: left
        custom_fields:
          résumé: |
            [[[
              const personnes = Object.values(states).filter(e => e.entity_id.startsWith('person.') && e.state === 'home').length;
              const totalPersonnes = Object.values(states).filter(e => e.entity_id.startsWith('person.')).length;

              const lumieres = states['sensor.nb_lumieres_allumees'] ? states['sensor.nb_lumieres_allumees'].state : "N/A";

              const puissance = states['sensor.conso_tempo_jour_total'] ? states['sensor.conso_tempo_jour_total'].state : "N/A";

              const appareils = Object.values(states).filter(e =>
                (e.entity_id.startsWith('switch.') || e.entity_id.startsWith('media_player.') || e.entity_id.startsWith('plug.')) &&
                e.state === 'on'
              ).length;

              const alertes = states['sensor.alertes_maison'] ? states['sensor.alertes_maison'].state : "Aucune";

              return `👨‍👩‍👧‍👦 Présents : ${personnes} / ${totalPersonnes}  
            💡 Lumières ON: ${lumieres}
            ⚡ Conso: ${puissance} kW
            💻 Appareils actifs: ${appareils}
            `; ]]]
    visible:
      - user: 9bd2c79bb7c44dd79f5b1aaf38d12367
    cards: []
